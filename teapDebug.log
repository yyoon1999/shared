FreeRADIUS Version 3.2.2
Copyright (C) 1999-2022 The FreeRADIUS server project and contributors
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE
You may redistribute copies of FreeRADIUS under the terms of the
GNU General Public License
For more information about these matters, see the file named COPYRIGHT
Starting - reading configuration files ...
including dictionary file /usr/local/share/freeradius/dictionary
including dictionary file /usr/local/share/freeradius/dictionary.dhcp
including dictionary file /usr/local/share/freeradius/dictionary.vqp
including dictionary file /usr/local/etc/raddb/dictionary
including configuration file /usr/local/etc/raddb/radiusd.conf
including configuration file /usr/local/etc/raddb/proxy.conf
including configuration file /usr/local/etc/raddb/clients.conf
including files in directory /usr/local/etc/raddb/mods-enabled/
including configuration file /usr/local/etc/raddb/mods-enabled/sradutmp
including configuration file /usr/local/etc/raddb/mods-enabled/realm
including configuration file /usr/local/etc/raddb/mods-enabled/attr_filter
including configuration file /usr/local/etc/raddb/mods-enabled/ntlm_auth
including configuration file /usr/local/etc/raddb/mods-enabled/replicate
including configuration file /usr/local/etc/raddb/mods-enabled/chap
including configuration file /usr/local/etc/raddb/mods-enabled/soh
including configuration file /usr/local/etc/raddb/mods-enabled/radutmp
including configuration file /usr/local/etc/raddb/mods-enabled/linelog
including configuration file /usr/local/etc/raddb/mods-enabled/logintime
including configuration file /usr/local/etc/raddb/mods-enabled/detail
including configuration file /usr/local/etc/raddb/mods-enabled/expr
including configuration file /usr/local/etc/raddb/mods-enabled/expiration
including configuration file /usr/local/etc/raddb/mods-enabled/files
including configuration file /usr/local/etc/raddb/mods-enabled/preprocess
including configuration file /usr/local/etc/raddb/mods-enabled/exec
including configuration file /usr/local/etc/raddb/mods-enabled/pap
including configuration file /usr/local/etc/raddb/mods-enabled/detail.log
including configuration file /usr/local/etc/raddb/mods-enabled/totp
including configuration file /usr/local/etc/raddb/mods-enabled/echo
including configuration file /usr/local/etc/raddb/mods-enabled/utf8
including configuration file /usr/local/etc/raddb/mods-enabled/date
including configuration file /usr/local/etc/raddb/mods-enabled/unix
including configuration file /usr/local/etc/raddb/mods-enabled/dynamic_clients
including configuration file /usr/local/etc/raddb/mods-enabled/always
including configuration file /usr/local/etc/raddb/mods-enabled/eap
including configuration file /usr/local/etc/raddb/mods-enabled/mschap
including configuration file /usr/local/etc/raddb/mods-enabled/passwd
including configuration file /usr/local/etc/raddb/mods-enabled/unpack
including configuration file /usr/local/etc/raddb/mods-enabled/digest
including files in directory /usr/local/etc/raddb/policy.d/
including configuration file /usr/local/etc/raddb/policy.d/cui
including configuration file /usr/local/etc/raddb/policy.d/accounting
including configuration file /usr/local/etc/raddb/policy.d/operator-name
including configuration file /usr/local/etc/raddb/policy.d/filter
including configuration file /usr/local/etc/raddb/policy.d/debug
including configuration file /usr/local/etc/raddb/policy.d/abfab-tr
including configuration file /usr/local/etc/raddb/policy.d/dhcp
including configuration file /usr/local/etc/raddb/policy.d/moonshot-targeted-ids
including configuration file /usr/local/etc/raddb/policy.d/rfc7542
including configuration file /usr/local/etc/raddb/policy.d/eap
including configuration file /usr/local/etc/raddb/policy.d/canonicalization
including configuration file /usr/local/etc/raddb/policy.d/control
including files in directory /usr/local/etc/raddb/sites-enabled/
including configuration file /usr/local/etc/raddb/sites-enabled/inner-tunnel
including configuration file /usr/local/etc/raddb/sites-enabled/default
main {
 security {
 	allow_core_dumps = no
 }
	name = "radiusd"
	prefix = "/usr/local"
	localstatedir = "/usr/local/var"
	logdir = "/usr/local/var/log/radius"
	run_dir = "/usr/local/var/run/radiusd"
}
main {
	name = "radiusd"
	prefix = "/usr/local"
	localstatedir = "/usr/local/var"
	sbindir = "/usr/local/sbin"
	logdir = "/usr/local/var/log/radius"
	run_dir = "/usr/local/var/run/radiusd"
	libdir = "/usr/local/lib"
	radacctdir = "/usr/local/var/log/radius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	postauth_client_lost = no
	pidfile = "/usr/local/var/run/radiusd/radiusd.pid"
	checkrad = "/usr/local/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 	allow_vulnerable_openssl = "no"
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	nonblock = no
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
  recv_coa {
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
 realm example.com {
 } # realm example.com
radiusd: #### Loading Clients ####
 client 10.54.23.0 {
 	ipaddr = 10.54.23.0/24
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 10.54.22.0 {
 	ipaddr = 10.54.22.0/24
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debugger not attached
 # Creating Auth-Type = mschap
 # Creating Auth-Type = eap
 # Creating Auth-Type = PAP
 # Creating Auth-Type = CHAP
 # Creating Auth-Type = MS-CHAP
 # Creating Auth-Type = TEAP
 # Creating Auth-Type = digest
 # Creating Autz-Type = New-TLS-Connection
radiusd: #### Instantiating modules ####
 modules {
  # Loaded module rlm_radutmp
  # Loading module "sradutmp" from file /usr/local/etc/raddb/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/usr/local/var/log/radius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /usr/local/etc/raddb/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /usr/local/etc/raddb/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "bangpath" from file /usr/local/etc/raddb/mods-enabled/realm
  realm bangpath {
  	format = "prefix"
  	delimiter = "!"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /usr/local/etc/raddb/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /usr/local/etc/raddb/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.coa" from file /usr/local/etc/raddb/mods-enabled/attr_filter
  attr_filter attr_filter.coa {
  	filename = "/usr/local/etc/raddb/mods-config/attr_filter/coa"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_exec
  # Loading module "ntlm_auth" from file /usr/local/etc/raddb/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /usr/local/etc/raddb/mods-enabled/replicate
  # Loaded module rlm_chap
  # Loading module "chap" from file /usr/local/etc/raddb/mods-enabled/chap
  # Loaded module rlm_soh
  # Loading module "soh" from file /usr/local/etc/raddb/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "radutmp" from file /usr/local/etc/raddb/mods-enabled/radutmp
  radutmp {
  	filename = "/usr/local/var/log/radius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /usr/local/etc/raddb/mods-enabled/linelog
  linelog {
  	filename = "/usr/local/var/log/radius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /usr/local/etc/raddb/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/usr/local/var/log/radius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /usr/local/etc/raddb/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_detail
  # Loading module "detail" from file /usr/local/etc/raddb/mods-enabled/detail
  detail {
  	filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_expr
  # Loading module "expr" from file /usr/local/etc/raddb/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /usr/local/etc/raddb/mods-enabled/expiration
  # Loaded module rlm_files
  # Loading module "files" from file /usr/local/etc/raddb/mods-enabled/files
  files {
  	filename = "/usr/local/etc/raddb/mods-config/files/authorize"
  	acctusersfile = "/usr/local/etc/raddb/mods-config/files/accounting"
  	preproxy_usersfile = "/usr/local/etc/raddb/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /usr/local/etc/raddb/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/usr/local/etc/raddb/mods-config/preprocess/huntgroups"
  	hints = "/usr/local/etc/raddb/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loading module "exec" from file /usr/local/etc/raddb/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /usr/local/etc/raddb/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loading module "auth_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  detail auth_log {
  	filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  detail reply_log {
  	filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_totp
  # Loading module "totp" from file /usr/local/etc/raddb/mods-enabled/totp
  # Loading module "echo" from file /usr/local/etc/raddb/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /usr/local/etc/raddb/mods-enabled/utf8
  # Loaded module rlm_date
  # Loading module "date" from file /usr/local/etc/raddb/mods-enabled/date
  date {
  	format = "%b %e %Y %H:%M:%S %Z"
  	utc = no
  }
  # Loading module "wispr2date" from file /usr/local/etc/raddb/mods-enabled/date
  date wispr2date {
  	format = "%Y-%m-%dT%H:%M:%S"
  	utc = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /usr/local/etc/raddb/mods-enabled/unix
  unix {
  	radwtmp = "/usr/local/var/log/radius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /usr/local/etc/raddb/mods-enabled/dynamic_clients
  # Loaded module rlm_always
  # Loading module "reject" from file /usr/local/etc/raddb/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /usr/local/etc/raddb/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /usr/local/etc/raddb/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /usr/local/etc/raddb/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /usr/local/etc/raddb/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /usr/local/etc/raddb/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /usr/local/etc/raddb/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /usr/local/etc/raddb/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /usr/local/etc/raddb/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_eap
  # Loading module "eap" from file /usr/local/etc/raddb/mods-enabled/eap
  eap {
  	default_eap_type = "teap"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /usr/local/etc/raddb/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  	winbind_retry_with_normalised_username = no
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /usr/local/etc/raddb/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /usr/local/etc/raddb/mods-enabled/unpack
  # Loaded module rlm_digest
  # Loading module "digest" from file /usr/local/etc/raddb/mods-enabled/digest
  instantiate {
  }
  # Instantiating module "IPASS" from file /usr/local/etc/raddb/mods-enabled/realm
  # Instantiating module "suffix" from file /usr/local/etc/raddb/mods-enabled/realm
  # Instantiating module "bangpath" from file /usr/local/etc/raddb/mods-enabled/realm
  # Instantiating module "realmpercent" from file /usr/local/etc/raddb/mods-enabled/realm
  # Instantiating module "ntdomain" from file /usr/local/etc/raddb/mods-enabled/realm
  # Instantiating module "attr_filter.post-proxy" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/access_reject
  # Instantiating module "attr_filter.access_challenge" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/accounting_response
  # Instantiating module "attr_filter.coa" from file /usr/local/etc/raddb/mods-enabled/attr_filter
reading pairlist file /usr/local/etc/raddb/mods-config/attr_filter/coa
  # Instantiating module "linelog" from file /usr/local/etc/raddb/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /usr/local/etc/raddb/mods-enabled/linelog
  # Instantiating module "logintime" from file /usr/local/etc/raddb/mods-enabled/logintime
  # Instantiating module "detail" from file /usr/local/etc/raddb/mods-enabled/detail
  # Instantiating module "expiration" from file /usr/local/etc/raddb/mods-enabled/expiration
  # Instantiating module "files" from file /usr/local/etc/raddb/mods-enabled/files
reading pairlist file /usr/local/etc/raddb/mods-config/files/authorize
reading pairlist file /usr/local/etc/raddb/mods-config/files/accounting
reading pairlist file /usr/local/etc/raddb/mods-config/files/pre-proxy
  # Instantiating module "preprocess" from file /usr/local/etc/raddb/mods-enabled/preprocess
reading pairlist file /usr/local/etc/raddb/mods-config/preprocess/huntgroups
reading pairlist file /usr/local/etc/raddb/mods-config/preprocess/hints
  # Instantiating module "pap" from file /usr/local/etc/raddb/mods-enabled/pap
  # Instantiating module "auth_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /usr/local/etc/raddb/mods-enabled/detail.log
  # Instantiating module "reject" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "fail" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "ok" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "handled" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "invalid" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "userlock" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "notfound" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "noop" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "updated" from file /usr/local/etc/raddb/mods-enabled/always
  # Instantiating module "eap" from file /usr/local/etc/raddb/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	verify_depth = 0
   	ca_path = "/usr/local/etc/raddb/certs"
   	pem_file_type = yes
   	private_key_file = "/usr/local/etc/raddb/certs/server.pem"
   	certificate_file = "/usr/local/etc/raddb/certs/server.pem"
   	ca_file = "/usr/local/etc/raddb/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	fragment_size = 1024
   	include_length = yes
   	auto_chain = yes
   	check_crl = no
   	check_all_crl = no
   	ca_path_reload_interval = 0
   	cipher_list = "DEFAULT"
   	cipher_server_preference = no
   	reject_unknown_intermediate_ca = no
   	ecdh_curve = ""
   	tls_max_version = "1.2"
   	tls_min_version = "1.2"
    cache {
    	enable = no
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    	skip_if_ocsp_ok = no
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
   # Linked to sub-module rlm_eap_teap
   teap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	require_client_cert = no
   	pac_lifetime = 604800
   	authority_identity = "1234"
   	pac_opaque_key = "0123456789abcdef0123456789ABCDEF"
   	virtual_server = "inner-tunnel"
   }
tls: Using cached TLS configuration from previous invocation
  # Instantiating module "mschap" from file /usr/local/etc/raddb/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "etc_passwd" from file /usr/local/etc/raddb/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /usr/local/etc/raddb/radiusd.conf
} # server
server inner-tunnel { # from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
 # Loading authenticate {...}
Compiling Auth-Type PAP for attr Auth-Type
Compiling Auth-Type CHAP for attr Auth-Type
Compiling Auth-Type MS-CHAP for attr Auth-Type
Compiling Auth-Type TEAP for attr Auth-Type
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
 # Skipping contents of 'if' as it is always 'false' -- /usr/local/etc/raddb/sites-enabled/inner-tunnel:432
Compiling Post-Auth-Type REJECT for attr Post-Auth-Type
} # server inner-tunnel
server default { # from file /usr/local/etc/raddb/sites-enabled/default
 # Loading authenticate {...}
Compiling Auth-Type PAP for attr Auth-Type
Compiling Auth-Type CHAP for attr Auth-Type
Compiling Auth-Type MS-CHAP for attr Auth-Type
 # Loading authorize {...}
Compiling Autz-Type New-TLS-Connection for attr Autz-Type
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
Compiling Post-Auth-Type REJECT for attr Post-Auth-Type
Compiling Post-Auth-Type Challenge for attr Post-Auth-Type
Compiling Post-Auth-Type Client-Lost for attr Post-Auth-Type
} # server default
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on proxy address * port 47465
Listening on proxy address :: port 37781
Ready to process requests
(0) Received Access-Request Id 125 from 10.54.22.81:32769 to 10.54.27.54:1812 length 150
(0)   Message-Authenticator = 0x2ff005c8db814b3354d6268ca22c87d2
(0)   User-Name = "anonymous"
(0)   NAS-IP-Address = 10.54.22.81
(0)   Called-Station-Id = "00-04-96-9b-5d-01"
(0)   NAS-Identifier = "X440G2-24t-10G4"
(0)   NAS-Port = 1005
(0)   NAS-Port-Type = Ethernet
(0)   Service-Type = Framed-User
(0)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(0)   EAP-Message = 0x023b000e01616e6f6e796d6f7573
(0)   Framed-MTU = 1300
(0) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(0)   authorize {
(0)     policy filter_username {
(0)       if (&User-Name) {
(0)       if (&User-Name)  -> TRUE
(0)       if (&User-Name)  {
(0)         if (&User-Name =~ / /) {
(0)         if (&User-Name =~ / /)  -> FALSE
(0)         if (&User-Name =~ /@[^@]*@/ ) {
(0)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(0)         if (&User-Name =~ /\.\./ ) {
(0)         if (&User-Name =~ /\.\./ )  -> FALSE
(0)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(0)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(0)         if (&User-Name =~ /\.$/)  {
(0)         if (&User-Name =~ /\.$/)   -> FALSE
(0)         if (&User-Name =~ /@\./)  {
(0)         if (&User-Name =~ /@\./)   -> FALSE
(0)       } # if (&User-Name)  = notfound
(0)     } # policy filter_username = notfound
(0)     [preprocess] = ok
(0)     [chap] = noop
(0)     [mschap] = noop
(0)     [digest] = noop
(0) suffix: Checking for suffix after "@"
(0) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(0) suffix: No such realm "NULL"
(0)     [suffix] = noop
(0) eap: Peer sent EAP Response (code 2) ID 59 length 14
(0) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(0)     [eap] = ok
(0)   } # authorize = ok
(0) Found Auth-Type = eap
(0) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(0)   authenticate {
(0) eap: Peer sent packet with method EAP Identity (1)
(0) eap: Calling submodule eap_teap to process data
(0) eap_teap: (TLS) Initiating new session
(0) eap: Sending EAP Request (code 1) ID 60 length 18
(0) eap: EAP session adding &reply:State = 0xd6d93510d6e50266
(0)     [eap] = handled
(0)   } # authenticate = handled
(0) Using Post-Auth-Type Challenge
(0) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(0)   Challenge { ... } # empty sub-section is ignored
(0) session-state: Saving cached attributes
(0)   Framed-MTU = 984
(0) Sent Access-Challenge Id 125 from 10.54.27.54:1812 to 10.54.22.81:32769 length 76
(0)   EAP-Message = 0x013c00123731000000080001000431323334
(0)   Message-Authenticator = 0x00000000000000000000000000000000
(0)   State = 0xd6d93510d6e50266cad7ad32b7cfd2a0
(0) Finished request
Waking up in 4.9 seconds.
(1) Received Access-Request Id 126 from 10.54.22.81:32769 to 10.54.27.54:1812 length 316
(1)   Message-Authenticator = 0xa92cf07d0f006d2be936963c0320655c
(1)   User-Name = "anonymous"
(1)   State = 0xd6d93510d6e50266cad7ad32b7cfd2a0
(1)   NAS-IP-Address = 10.54.22.81
(1)   Called-Station-Id = "00-04-96-9b-5d-01"
(1)   NAS-Identifier = "X440G2-24t-10G4"
(1)   NAS-Port = 1005
(1)   NAS-Port-Type = Ethernet
(1)   Framed-MTU = 1300
(1)   Service-Type = Framed-User
(1)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(1)   EAP-Message = 0x023c00a23701160303009701000093030363ef938672554f1bdc7df0d57d1683ac03fd7c62f1dc4bdc1483d26abe3d5af6000024c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000046000500050100000000000a00080006001d00170018000b00020100000d001a00180804080508060401050102010403050302030202060106030023000000170000ff01000100
(1) Restoring &session-state
(1)   &session-state:Framed-MTU = 984
(1) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(1)   authorize {
(1)     policy filter_username {
(1)       if (&User-Name) {
(1)       if (&User-Name)  -> TRUE
(1)       if (&User-Name)  {
(1)         if (&User-Name =~ / /) {
(1)         if (&User-Name =~ / /)  -> FALSE
(1)         if (&User-Name =~ /@[^@]*@/ ) {
(1)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(1)         if (&User-Name =~ /\.\./ ) {
(1)         if (&User-Name =~ /\.\./ )  -> FALSE
(1)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(1)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(1)         if (&User-Name =~ /\.$/)  {
(1)         if (&User-Name =~ /\.$/)   -> FALSE
(1)         if (&User-Name =~ /@\./)  {
(1)         if (&User-Name =~ /@\./)   -> FALSE
(1)       } # if (&User-Name)  = notfound
(1)     } # policy filter_username = notfound
(1)     [preprocess] = ok
(1)     [chap] = noop
(1)     [mschap] = noop
(1)     [digest] = noop
(1) suffix: Checking for suffix after "@"
(1) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(1) suffix: No such realm "NULL"
(1)     [suffix] = noop
(1) eap: Peer sent EAP Response (code 2) ID 60 length 162
(1) eap: No EAP Start, assuming it's an on-going EAP conversation
(1)     [eap] = updated
(1)     [files] = noop
(1)     [expiration] = noop
(1)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(1)     [pap] = noop
(1)   } # authorize = updated
(1) Found Auth-Type = eap
(1) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(1)   authenticate {
(1) eap: Expiring EAP session with state 0xd6d93510d6e50266
(1) eap: Finished EAP session with state 0xd6d93510d6e50266
(1) eap: Previous EAP request found for state 0xd6d93510d6e50266, released from the list
(1) eap: Peer sent packet with method EAP TEAP (55)
(1) eap: Calling submodule eap_teap to process data
(1) eap_teap: Authenticate
(1) eap_teap: (TLS) EAP Got final fragment (156 bytes)
(1) eap_teap: WARNING: (TLS) EAP Total received record fragments (156 bytes), does not equal expected expected data length (0 bytes)
(1) eap_teap: (TLS) EAP Done initial handshake
(1) eap_teap: (TLS) Handshake state - before SSL initialization
(1) eap_teap: (TLS) Handshake state - Server before SSL initialization
(1) eap_teap: (TLS) Handshake state - Server before SSL initialization
(1) eap_teap: (TLS) recv TLS 1.3 Handshake, ClientHello
(1) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read client hello
(1) eap_teap: (TLS) send TLS 1.2 Handshake, ServerHello
(1) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server hello
(1) eap_teap: (TLS) send TLS 1.2 Handshake, Certificate
(1) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write certificate
(1) eap_teap: (TLS) send TLS 1.2 Handshake, ServerKeyExchange
(1) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write key exchange
(1) eap_teap: (TLS) send TLS 1.2 Handshake, ServerHelloDone
(1) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server done
(1) eap_teap: (TLS) Server : Need to read more data: SSLv3/TLS write server done
(1) eap_teap: (TLS) In Handshake Phase
(1) eap: Sending EAP Request (code 1) ID 61 length 994
(1) eap: EAP session adding &reply:State = 0xd6d93510d7e40266
(1)     [eap] = handled
(1)   } # authenticate = handled
(1) Using Post-Auth-Type Challenge
(1) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(1)   Challenge { ... } # empty sub-section is ignored
(1) session-state: Saving cached attributes
(1)   Framed-MTU = 984
(1)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(1)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(1)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(1)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(1)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(1) Sent Access-Challenge Id 126 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1058
(1)   EAP-Message = 0x013d03e237c100000cc5160303003d020000390303013cb5a6985e2e6a011ffee8b575adf5d895db53c1ef3d66f95d986e0560f54f00c030000011ff01000100000b000403000102001700001603030a440b000a40000a3d00068b308206873082056fa0030201020213190000002839d906f0560dcaa7000200000028300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3232313230373134303232325a170d3234313230363134303232325a306a310b3009060355040613025553310b3009060355040813024e48311430120603550407130b4c6f6e646f6e6465727279310a3008060355040a130141310a3008060355040b1301443120301e060355040313174e41432d323137312e657874727161323031322e636f6d30820222300d06092a86
(1)   Message-Authenticator = 0x00000000000000000000000000000000
(1)   State = 0xd6d93510d7e40266cad7ad32b7cfd2a0
(1) Finished request
Waking up in 4.9 seconds.
(2) Received Access-Request Id 127 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(2)   Message-Authenticator = 0x9de6f29ea90c3244241fc4dd5e6e7343
(2)   User-Name = "anonymous"
(2)   State = 0xd6d93510d7e40266cad7ad32b7cfd2a0
(2)   NAS-IP-Address = 10.54.22.81
(2)   Called-Station-Id = "00-04-96-9b-5d-01"
(2)   NAS-Identifier = "X440G2-24t-10G4"
(2)   NAS-Port = 1005
(2)   NAS-Port-Type = Ethernet
(2)   Framed-MTU = 1300
(2)   Service-Type = Framed-User
(2)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(2)   EAP-Message = 0x023d00063701
(2) Restoring &session-state
(2)   &session-state:Framed-MTU = 984
(2)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(2)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(2)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(2)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(2)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(2) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(2)   authorize {
(2)     policy filter_username {
(2)       if (&User-Name) {
(2)       if (&User-Name)  -> TRUE
(2)       if (&User-Name)  {
(2)         if (&User-Name =~ / /) {
(2)         if (&User-Name =~ / /)  -> FALSE
(2)         if (&User-Name =~ /@[^@]*@/ ) {
(2)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(2)         if (&User-Name =~ /\.\./ ) {
(2)         if (&User-Name =~ /\.\./ )  -> FALSE
(2)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(2)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(2)         if (&User-Name =~ /\.$/)  {
(2)         if (&User-Name =~ /\.$/)   -> FALSE
(2)         if (&User-Name =~ /@\./)  {
(2)         if (&User-Name =~ /@\./)   -> FALSE
(2)       } # if (&User-Name)  = notfound
(2)     } # policy filter_username = notfound
(2)     [preprocess] = ok
(2)     [chap] = noop
(2)     [mschap] = noop
(2)     [digest] = noop
(2) suffix: Checking for suffix after "@"
(2) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(2) suffix: No such realm "NULL"
(2)     [suffix] = noop
(2) eap: Peer sent EAP Response (code 2) ID 61 length 6
(2) eap: No EAP Start, assuming it's an on-going EAP conversation
(2)     [eap] = updated
(2)     [files] = noop
(2)     [expiration] = noop
(2)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(2)     [pap] = noop
(2)   } # authorize = updated
(2) Found Auth-Type = eap
(2) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(2)   authenticate {
(2) eap: Expiring EAP session with state 0xd6d93510d7e40266
(2) eap: Finished EAP session with state 0xd6d93510d7e40266
(2) eap: Previous EAP request found for state 0xd6d93510d7e40266, released from the list
(2) eap: Peer sent packet with method EAP TEAP (55)
(2) eap: Calling submodule eap_teap to process data
(2) eap_teap: Authenticate
(2) eap_teap: (TLS) Peer ACKed our handshake fragment
(2) eap: Sending EAP Request (code 1) ID 62 length 990
(2) eap: EAP session adding &reply:State = 0xd6d93510d4e70266
(2)     [eap] = handled
(2)   } # authenticate = handled
(2) Using Post-Auth-Type Challenge
(2) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(2)   Challenge { ... } # empty sub-section is ignored
(2) session-state: Saving cached attributes
(2)   Framed-MTU = 984
(2)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(2)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(2)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(2)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(2)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(2) Sent Access-Challenge Id 127 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1054
(2)   EAP-Message = 0x013e03de37411f0481d53081d23081cfa081cca081c98681c66c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412831292c434e3d57494e3230313252322c434e3d4344502c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d455854525141323031322c44433d636f6d3f63657274696669636174655265766f636174696f6e4c6973743f626173653f6f626a656374436c6173733d63524c446973747269627574696f6e506f696e743081cc06082b060105050701010481bf3081bc3081b906082b060105050730028681ac6c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412c434e3d4149412c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d455854525141323031322c44433d636f
(2)   Message-Authenticator = 0x00000000000000000000000000000000
(2)   State = 0xd6d93510d4e70266cad7ad32b7cfd2a0
(2) Finished request
Waking up in 4.9 seconds.
(3) Received Access-Request Id 128 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(3)   Message-Authenticator = 0xc1f50f2d547512b948c79f08927bfc28
(3)   User-Name = "anonymous"
(3)   State = 0xd6d93510d4e70266cad7ad32b7cfd2a0
(3)   NAS-IP-Address = 10.54.22.81
(3)   Called-Station-Id = "00-04-96-9b-5d-01"
(3)   NAS-Identifier = "X440G2-24t-10G4"
(3)   NAS-Port = 1005
(3)   NAS-Port-Type = Ethernet
(3)   Framed-MTU = 1300
(3)   Service-Type = Framed-User
(3)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(3)   EAP-Message = 0x023e00063701
(3) Restoring &session-state
(3)   &session-state:Framed-MTU = 984
(3)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(3) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(3)   authorize {
(3)     policy filter_username {
(3)       if (&User-Name) {
(3)       if (&User-Name)  -> TRUE
(3)       if (&User-Name)  {
(3)         if (&User-Name =~ / /) {
(3)         if (&User-Name =~ / /)  -> FALSE
(3)         if (&User-Name =~ /@[^@]*@/ ) {
(3)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(3)         if (&User-Name =~ /\.\./ ) {
(3)         if (&User-Name =~ /\.\./ )  -> FALSE
(3)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(3)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(3)         if (&User-Name =~ /\.$/)  {
(3)         if (&User-Name =~ /\.$/)   -> FALSE
(3)         if (&User-Name =~ /@\./)  {
(3)         if (&User-Name =~ /@\./)   -> FALSE
(3)       } # if (&User-Name)  = notfound
(3)     } # policy filter_username = notfound
(3)     [preprocess] = ok
(3)     [chap] = noop
(3)     [mschap] = noop
(3)     [digest] = noop
(3) suffix: Checking for suffix after "@"
(3) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(3) suffix: No such realm "NULL"
(3)     [suffix] = noop
(3) eap: Peer sent EAP Response (code 2) ID 62 length 6
(3) eap: No EAP Start, assuming it's an on-going EAP conversation
(3)     [eap] = updated
(3)     [files] = noop
(3)     [expiration] = noop
(3)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(3)     [pap] = noop
(3)   } # authorize = updated
(3) Found Auth-Type = eap
(3) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(3)   authenticate {
(3) eap: Expiring EAP session with state 0xd6d93510d4e70266
(3) eap: Finished EAP session with state 0xd6d93510d4e70266
(3) eap: Previous EAP request found for state 0xd6d93510d4e70266, released from the list
(3) eap: Peer sent packet with method EAP TEAP (55)
(3) eap: Calling submodule eap_teap to process data
(3) eap_teap: Authenticate
(3) eap_teap: (TLS) Peer ACKed our handshake fragment
(3) eap: Sending EAP Request (code 1) ID 63 length 990
(3) eap: EAP session adding &reply:State = 0xd6d93510d5e60266
(3)     [eap] = handled
(3)   } # authenticate = handled
(3) Using Post-Auth-Type Challenge
(3) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(3)   Challenge { ... } # empty sub-section is ignored
(3) session-state: Saving cached attributes
(3)   Framed-MTU = 984
(3)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(3)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(3)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(3)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(3)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(3) Sent Access-Challenge Id 128 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1054
(3)   EAP-Message = 0x013f03de374141323031323120301e06035504031317455854525141323031322d57494e3230313252322d434130820122300d06092a864886f70d01010105000382010f003082010a0282010100c5df228307acbda10e7e7882c15e8a14c74a3e7cf71f3a17562359b95b367af7d7b94dd2f8f9b34a252105f55b39a8882a46ba6b8cfa91a89cea9fcdc949bff239927510d1e18b48bed184412961076e535744fed109eaf694efbc4c5c56baff4c1a849dc4757341c1bf15f0c021488ea1a8b67f07e2d1670325a40e432f22e3dabb2069247eef899ca879a2273a918f5028cf016673ea2b970735b5b585d92b6a80526fec3cea7f6465e42e400a02423fb2693b7cc1d98f6ed644c5d2af8233a81c1217f13683797079b493c51c4a1f5b0abd5276eeaf0e247a4c7e9a292496b297df42d15a5709ccdfe17608afab92278650b3d769231a49c131608c8f8c290203010001a3783076300b0603551d0f040403020186300f0603551d130101ff040530030101ff301d
(3)   Message-Authenticator = 0x00000000000000000000000000000000
(3)   State = 0xd6d93510d5e60266cad7ad32b7cfd2a0
(3) Finished request
Waking up in 4.9 seconds.
(4) Received Access-Request Id 129 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(4)   Message-Authenticator = 0x5e59ebdcb0db6cf10ca8df71286748f6
(4)   User-Name = "anonymous"
(4)   State = 0xd6d93510d5e60266cad7ad32b7cfd2a0
(4)   NAS-IP-Address = 10.54.22.81
(4)   Called-Station-Id = "00-04-96-9b-5d-01"
(4)   NAS-Identifier = "X440G2-24t-10G4"
(4)   NAS-Port = 1005
(4)   NAS-Port-Type = Ethernet
(4)   Framed-MTU = 1300
(4)   Service-Type = Framed-User
(4)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(4)   EAP-Message = 0x023f00063701
(4) Restoring &session-state
(4)   &session-state:Framed-MTU = 984
(4)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(4) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(4)   authorize {
(4)     policy filter_username {
(4)       if (&User-Name) {
(4)       if (&User-Name)  -> TRUE
(4)       if (&User-Name)  {
(4)         if (&User-Name =~ / /) {
(4)         if (&User-Name =~ / /)  -> FALSE
(4)         if (&User-Name =~ /@[^@]*@/ ) {
(4)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(4)         if (&User-Name =~ /\.\./ ) {
(4)         if (&User-Name =~ /\.\./ )  -> FALSE
(4)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(4)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(4)         if (&User-Name =~ /\.$/)  {
(4)         if (&User-Name =~ /\.$/)   -> FALSE
(4)         if (&User-Name =~ /@\./)  {
(4)         if (&User-Name =~ /@\./)   -> FALSE
(4)       } # if (&User-Name)  = notfound
(4)     } # policy filter_username = notfound
(4)     [preprocess] = ok
(4)     [chap] = noop
(4)     [mschap] = noop
(4)     [digest] = noop
(4) suffix: Checking for suffix after "@"
(4) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(4) suffix: No such realm "NULL"
(4)     [suffix] = noop
(4) eap: Peer sent EAP Response (code 2) ID 63 length 6
(4) eap: No EAP Start, assuming it's an on-going EAP conversation
(4)     [eap] = updated
(4)     [files] = noop
(4)     [expiration] = noop
(4)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(4)     [pap] = noop
(4)   } # authorize = updated
(4) Found Auth-Type = eap
(4) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(4)   authenticate {
(4) eap: Expiring EAP session with state 0xd6d93510d5e60266
(4) eap: Finished EAP session with state 0xd6d93510d5e60266
(4) eap: Previous EAP request found for state 0xd6d93510d5e60266, released from the list
(4) eap: Peer sent packet with method EAP TEAP (55)
(4) eap: Calling submodule eap_teap to process data
(4) eap_teap: Authenticate
(4) eap_teap: (TLS) Peer ACKed our handshake fragment
(4) eap: Sending EAP Request (code 1) ID 64 length 323
(4) eap: EAP session adding &reply:State = 0xd6d93510d2990266
(4)     [eap] = handled
(4)   } # authenticate = handled
(4) Using Post-Auth-Type Challenge
(4) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(4)   Challenge { ... } # empty sub-section is ignored
(4) session-state: Saving cached attributes
(4)   Framed-MTU = 984
(4)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(4)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(4)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(4)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(4)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(4) Sent Access-Challenge Id 129 from 10.54.27.54:1812 to 10.54.22.81:32769 length 383
(4)   EAP-Message = 0x014001433701254fbfb22cf5e0aa85f33014dd2029a7aae95aae1700ee6fd75ffe58db3fa57333565a3bf84a965d52f5d6c24f15b29a41705fe68980e4b9061243277226ad9d555f823244aeed0e53fa7d43f15917e88005cfa2523adef4c456c41202979b980f31b8a7e2f11fa03ff386a17324e994368599961695ce8276ab5bfda18a1178a3d1ad6067447883c3d19512167eb9a88de7a9feab2b5928b997dd95cb89002b0c88588d70d9a7d4aa9f29f1d841ed404785e2daa5a45b6ae048c04533df40e41bc2511a23c23d002aa37c8fca7edbe47a9166827c1d38923457297e2e45df51c2c28d0e7e49ff6fd50474672c5f243d61d21371226a441dc95c1a43cb5a7ef7578bc190c7a77f2c81327e08c80d591b8008d1510a7eeb2de0aa3d4b37e519716e404bed61f5fa7aae6bc7eaa276d043cad0ddac16030300040e000000
(4)   Message-Authenticator = 0x00000000000000000000000000000000
(4)   State = 0xd6d93510d2990266cad7ad32b7cfd2a0
(4) Finished request
Waking up in 4.9 seconds.
(5) Received Access-Request Id 130 from 10.54.22.81:32769 to 10.54.27.54:1812 length 253
(5)   Message-Authenticator = 0xa487776969e13640ee3481af564b294d
(5)   User-Name = "anonymous"
(5)   State = 0xd6d93510d2990266cad7ad32b7cfd2a0
(5)   NAS-IP-Address = 10.54.22.81
(5)   Called-Station-Id = "00-04-96-9b-5d-01"
(5)   NAS-Identifier = "X440G2-24t-10G4"
(5)   NAS-Port = 1005
(5)   NAS-Port-Type = Ethernet
(5)   Framed-MTU = 1300
(5)   Service-Type = Framed-User
(5)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(5)   EAP-Message = 0x0240006337011603030025100000212001aec3a044a719b2711f78fafcefb6af38691950e35c9478c54c5fc4841f405414030300010116030300280000000000000000e93b7e6616986f74189e82795f67beff3a3637d1d2bd8f2a37b62114c581aa70
(5) Restoring &session-state
(5)   &session-state:Framed-MTU = 984
(5)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(5) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(5)   authorize {
(5)     policy filter_username {
(5)       if (&User-Name) {
(5)       if (&User-Name)  -> TRUE
(5)       if (&User-Name)  {
(5)         if (&User-Name =~ / /) {
(5)         if (&User-Name =~ / /)  -> FALSE
(5)         if (&User-Name =~ /@[^@]*@/ ) {
(5)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(5)         if (&User-Name =~ /\.\./ ) {
(5)         if (&User-Name =~ /\.\./ )  -> FALSE
(5)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(5)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(5)         if (&User-Name =~ /\.$/)  {
(5)         if (&User-Name =~ /\.$/)   -> FALSE
(5)         if (&User-Name =~ /@\./)  {
(5)         if (&User-Name =~ /@\./)   -> FALSE
(5)       } # if (&User-Name)  = notfound
(5)     } # policy filter_username = notfound
(5)     [preprocess] = ok
(5)     [chap] = noop
(5)     [mschap] = noop
(5)     [digest] = noop
(5) suffix: Checking for suffix after "@"
(5) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(5) suffix: No such realm "NULL"
(5)     [suffix] = noop
(5) eap: Peer sent EAP Response (code 2) ID 64 length 99
(5) eap: No EAP Start, assuming it's an on-going EAP conversation
(5)     [eap] = updated
(5)     [files] = noop
(5)     [expiration] = noop
(5)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(5)     [pap] = noop
(5)   } # authorize = updated
(5) Found Auth-Type = eap
(5) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(5)   authenticate {
(5) eap: Expiring EAP session with state 0xd6d93510d2990266
(5) eap: Finished EAP session with state 0xd6d93510d2990266
(5) eap: Previous EAP request found for state 0xd6d93510d2990266, released from the list
(5) eap: Peer sent packet with method EAP TEAP (55)
(5) eap: Calling submodule eap_teap to process data
(5) eap_teap: Authenticate
(5) eap_teap: (TLS) EAP Done initial handshake
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server done
(5) eap_teap: (TLS) recv TLS 1.2 Handshake, ClientKeyExchange
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read client key exchange
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read change cipher spec
(5) eap_teap: (TLS) recv TLS 1.2 Handshake, Finished
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read finished
(5) eap_teap: (TLS) send TLS 1.2 ChangeCipherSpec
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write change cipher spec
(5) eap_teap: (TLS) send TLS 1.2 Handshake, Finished
(5) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write finished
(5) eap_teap: (TLS) Handshake state - SSL negotiation finished successfully
(5) eap_teap: (TLS) Connection Established
(5) eap_teap:   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(5) eap_teap:   TLS-Session-Version = "TLS 1.2"
(5) eap: Sending EAP Request (code 1) ID 65 length 57
(5) eap: EAP session adding &reply:State = 0xd6d93510d3980266
(5)     [eap] = handled
(5)   } # authenticate = handled
(5) Using Post-Auth-Type Challenge
(5) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(5)   Challenge { ... } # empty sub-section is ignored
(5) session-state: Saving cached attributes
(5)   Framed-MTU = 984
(5)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(5)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(5)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(5)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(5)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(5)   TLS-Session-Version = "TLS 1.2"
(5) Sent Access-Challenge Id 130 from 10.54.27.54:1812 to 10.54.22.81:32769 length 115
(5)   EAP-Message = 0x01410039370114030300010116030300280bfe04df709db192cd62bdd7c6e74e707108f4ea20525c716687edeacd2a9a37b31ad26a83cd4753
(5)   Message-Authenticator = 0x00000000000000000000000000000000
(5)   State = 0xd6d93510d3980266cad7ad32b7cfd2a0
(5) Finished request
Waking up in 4.9 seconds.
(6) Received Access-Request Id 131 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(6)   Message-Authenticator = 0x6b176de782d865f51957125463e43e39
(6)   User-Name = "anonymous"
(6)   State = 0xd6d93510d3980266cad7ad32b7cfd2a0
(6)   NAS-IP-Address = 10.54.22.81
(6)   Called-Station-Id = "00-04-96-9b-5d-01"
(6)   NAS-Identifier = "X440G2-24t-10G4"
(6)   NAS-Port = 1005
(6)   NAS-Port-Type = Ethernet
(6)   Framed-MTU = 1300
(6)   Service-Type = Framed-User
(6)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(6)   EAP-Message = 0x024100063701
(6) Restoring &session-state
(6)   &session-state:Framed-MTU = 984
(6)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(6)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(6)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(6)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(6)   &session-state:TLS-Session-Version = "TLS 1.2"
(6) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(6)   authorize {
(6)     policy filter_username {
(6)       if (&User-Name) {
(6)       if (&User-Name)  -> TRUE
(6)       if (&User-Name)  {
(6)         if (&User-Name =~ / /) {
(6)         if (&User-Name =~ / /)  -> FALSE
(6)         if (&User-Name =~ /@[^@]*@/ ) {
(6)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(6)         if (&User-Name =~ /\.\./ ) {
(6)         if (&User-Name =~ /\.\./ )  -> FALSE
(6)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(6)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(6)         if (&User-Name =~ /\.$/)  {
(6)         if (&User-Name =~ /\.$/)   -> FALSE
(6)         if (&User-Name =~ /@\./)  {
(6)         if (&User-Name =~ /@\./)   -> FALSE
(6)       } # if (&User-Name)  = notfound
(6)     } # policy filter_username = notfound
(6)     [preprocess] = ok
(6)     [chap] = noop
(6)     [mschap] = noop
(6)     [digest] = noop
(6) suffix: Checking for suffix after "@"
(6) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(6) suffix: No such realm "NULL"
(6)     [suffix] = noop
(6) eap: Peer sent EAP Response (code 2) ID 65 length 6
(6) eap: No EAP Start, assuming it's an on-going EAP conversation
(6)     [eap] = updated
(6)     [files] = noop
(6)     [expiration] = noop
(6)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(6)     [pap] = noop
(6)   } # authorize = updated
(6) Found Auth-Type = eap
(6) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(6)   authenticate {
(6) eap: Expiring EAP session with state 0xd6d93510d3980266
(6) eap: Finished EAP session with state 0xd6d93510d3980266
(6) eap: Previous EAP request found for state 0xd6d93510d3980266, released from the list
(6) eap: Peer sent packet with method EAP TEAP (55)
(6) eap: Calling submodule eap_teap to process data
(6) eap_teap: Authenticate
(6) eap_teap: (TLS) Peer ACKed our handshake fragment.  handshake is finished
(6) eap_teap: Session established.  Proceeding to decode tunneled attributes
(6) eap_teap: Using authenticated provisioning
(6) eap_teap: Using MAC SHA384 (673)
(6) eap_teap: Deriving EAP-TEAP keys
(6) eap_teap: S-IMCK[0] - hexdump(len=40): cf 16 fc a0 63 ec c3 90 e8 50 2f a4 c6 e6 94 4d e6 2a 06 71 31 e4 58 3f 4b d7 94 70 7a 39 d0 aa 63 1b a3 fe c6 12 20 42
(6) eap_teap: Sending EAP-Identity
(6) eap: Sending EAP Request (code 1) ID 66 length 44
(6) eap: EAP session adding &reply:State = 0xd6d93510d09b0266
(6)     [eap] = handled
(6)   } # authenticate = handled
(6) Using Post-Auth-Type Challenge
(6) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(6)   Challenge { ... } # empty sub-section is ignored
(6) session-state: Saving cached attributes
(6)   Framed-MTU = 984
(6)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(6)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(6)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(6)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(6)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(6)   TLS-Session-Version = "TLS 1.2"
(6) Sent Access-Challenge Id 131 from 10.54.27.54:1812 to 10.54.22.81:32769 length 102
(6)   EAP-Message = 0x0142002c370117030300210bfe04df709db1938db180ff1b71792b515aa0718f8ced0eb2e0fcde0b4720b3c6
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0xd6d93510d09b0266cad7ad32b7cfd2a0
(6) Finished request
Waking up in 4.8 seconds.
(7) Received Access-Request Id 132 from 10.54.22.81:32769 to 10.54.27.54:1812 length 198
(7)   Message-Authenticator = 0x27858ddf4fd4a57150209e33b3ecec99
(7)   User-Name = "anonymous"
(7)   State = 0xd6d93510d09b0266cad7ad32b7cfd2a0
(7)   NAS-IP-Address = 10.54.22.81
(7)   Called-Station-Id = "00-04-96-9b-5d-01"
(7)   NAS-Identifier = "X440G2-24t-10G4"
(7)   NAS-Port = 1005
(7)   NAS-Port-Type = Ethernet
(7)   Framed-MTU = 1300
(7)   Service-Type = Framed-User
(7)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(7)   EAP-Message = 0x0242002c370117030300210000000000000001fc6ea99e6a9c9111ca399367dc46f33839a624685ca065679a
(7) Restoring &session-state
(7)   &session-state:Framed-MTU = 984
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(7)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(7)   &session-state:TLS-Session-Version = "TLS 1.2"
(7) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(7)   authorize {
(7)     policy filter_username {
(7)       if (&User-Name) {
(7)       if (&User-Name)  -> TRUE
(7)       if (&User-Name)  {
(7)         if (&User-Name =~ / /) {
(7)         if (&User-Name =~ / /)  -> FALSE
(7)         if (&User-Name =~ /@[^@]*@/ ) {
(7)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(7)         if (&User-Name =~ /\.\./ ) {
(7)         if (&User-Name =~ /\.\./ )  -> FALSE
(7)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(7)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(7)         if (&User-Name =~ /\.$/)  {
(7)         if (&User-Name =~ /\.$/)   -> FALSE
(7)         if (&User-Name =~ /@\./)  {
(7)         if (&User-Name =~ /@\./)   -> FALSE
(7)       } # if (&User-Name)  = notfound
(7)     } # policy filter_username = notfound
(7)     [preprocess] = ok
(7)     [chap] = noop
(7)     [mschap] = noop
(7)     [digest] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)     [suffix] = noop
(7) eap: Peer sent EAP Response (code 2) ID 66 length 44
(7) eap: No EAP Start, assuming it's an on-going EAP conversation
(7)     [eap] = updated
(7)     [files] = noop
(7)     [expiration] = noop
(7)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(7)     [pap] = noop
(7)   } # authorize = updated
(7) Found Auth-Type = eap
(7) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(7)   authenticate {
(7) eap: Expiring EAP session with state 0xd6d93510d09b0266
(7) eap: Finished EAP session with state 0xd6d93510d09b0266
(7) eap: Previous EAP request found for state 0xd6d93510d09b0266, released from the list
(7) eap: Peer sent packet with method EAP TEAP (55)
(7) eap: Calling submodule eap_teap to process data
(7) eap_teap: Authenticate
(7) eap_teap: (TLS) EAP Done initial handshake
(7) eap_teap: Session established.  Proceeding to decode tunneled attributes
(7) eap_teap: Got Tunneled TEAP TLVs
(7) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x0242000501
(7) eap_teap: Processing received EAP Payload
(7) eap_teap: Got tunneled request
(7) eap_teap:   EAP-Message = 0x0242000501
(7) eap_teap: WARNING: No EAP-Identity found to start EAP conversation
(7) eap_teap: AUTHENTICATION
(7) Virtual server inner-tunnel received request
(7)   EAP-Message = 0x0242000501
(7)   FreeRADIUS-Proxied-To = 127.0.0.1
(7) server inner-tunnel {
(7)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(7)     authorize {
(7)       policy filter_username {
(7)         if (&User-Name) {
(7)         if (&User-Name)  -> FALSE
(7)       } # policy filter_username = notfound
(7)       [chap] = noop
(7)       [mschap] = noop
(7) suffix: Proxy reply, or no User-Name.  Ignoring
(7)       [suffix] = noop
(7)       update control {
(7)         &Proxy-To-Realm := LOCAL
(7)       } # update control = noop
(7)       if (&outer.request:EAP-Type == TEAP) {
(7)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(7)       if (&outer.request:EAP-Type == TEAP)  {
(7)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(7)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(7)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(7)           update reply {
(7)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(7)           } # update reply = noop
(7)           update session-state {
(7)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(7)           } # update session-state = noop
(7)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(7)         ... skipping elsif: Preceding "if" was taken
(7) eap: Peer sent EAP Response (code 2) ID 66 length 5
(7) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(7)         [eap] = ok
(7)         if (ok) {
(7)         if (ok)  -> TRUE
(7)         if (ok)  {
(7)           update config {
(7)             &Auth-Type := TEAP
(7)           } # update config = noop
(7)           return
(7)         } # if (ok)  = noop
(7)       } # if (&outer.request:EAP-Type == TEAP)  = ok
(7)     } # authorize = ok
(7)   Found Auth-Type = TEAP
(7)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(7)     Auth-Type TEAP {
(7)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(7)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(7)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(7)         update control {
(7)           &EAP-Type := TLS
(7)         } # update control = noop
(7)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(7)       ... skipping elsif: Preceding "if" was taken
(7) eap: ERROR: EAP-Identity Unknown
(7) eap: Identity Unknown, authentication failed
(7) eap: Failed in handler
(7)       [eap] = invalid
(7)     } # Auth-Type TEAP = invalid
(7)   Failed to authenticate the user
(7)   Using Post-Auth-Type Reject
(7)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(7)     Post-Auth-Type REJECT {
(7) attr_filter.access_reject: EXPAND %{User-Name}
(7) attr_filter.access_reject:    --> 
(7)       [attr_filter.access_reject] = noop
(7)       update outer.session-state {
(7)         &Module-Failure-Message := &request:Module-Failure-Message -> 'eap: EAP-Identity Unknown'
(7)       } # update outer.session-state = noop
(7)     } # Post-Auth-Type REJECT = noop
(7) } # server inner-tunnel
(7) Virtual server sending reply
(7)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(7) eap_teap: Got tunneled Access-Reject
(7) eap: ERROR: Failed continuing EAP TEAP (55) session.  EAP sub-module failed
(7) eap: Sending EAP Failure (code 4) ID 66 length 4
(7) eap: Failed in EAP select
(7)     [eap] = invalid
(7)   } # authenticate = invalid
(7) Failed to authenticate the user
(7) Using Post-Auth-Type Reject
(7) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(7)   Post-Auth-Type REJECT {
(7) attr_filter.access_reject: EXPAND %{User-Name}
(7) attr_filter.access_reject:    --> anonymous
(7) attr_filter.access_reject: Matched entry DEFAULT at line 11
(7)     [attr_filter.access_reject] = updated
(7)     [eap] = noop
(7)     policy remove_reply_message_if_eap {
(7)       if (&reply:EAP-Message && &reply:Reply-Message) {
(7)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(7)       else {
(7)         [noop] = noop
(7)       } # else = noop
(7)     } # policy remove_reply_message_if_eap = noop
(7)   } # Post-Auth-Type REJECT = updated
(7) Delaying response for 1.000000 seconds
Waking up in 0.3 seconds.
Waking up in 0.6 seconds.
(7) Sending delayed response
(7) Sent Access-Reject Id 132 from 10.54.27.54:1812 to 10.54.22.81:32769 length 44
(7)   EAP-Message = 0x04420004
(7)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 3.7 seconds.
(0) Cleaning up request packet ID 125 with timestamp +40 due to cleanup_delay was reached
(1) Cleaning up request packet ID 126 with timestamp +40 due to cleanup_delay was reached
(2) Cleaning up request packet ID 127 with timestamp +40 due to cleanup_delay was reached
(3) Cleaning up request packet ID 128 with timestamp +40 due to cleanup_delay was reached
(4) Cleaning up request packet ID 129 with timestamp +40 due to cleanup_delay was reached
(5) Cleaning up request packet ID 130 with timestamp +40 due to cleanup_delay was reached
(6) Cleaning up request packet ID 131 with timestamp +40 due to cleanup_delay was reached
Waking up in 0.1 seconds.
(7) Cleaning up request packet ID 132 with timestamp +41 due to cleanup_delay was reached
Ready to process requests
(8) Received Access-Request Id 133 from 10.54.22.81:32769 to 10.54.27.54:1812 length 150
(8)   Message-Authenticator = 0x1e8b7083fe86489677d713611fb930c7
(8)   User-Name = "anonymous"
(8)   NAS-IP-Address = 10.54.22.81
(8)   Called-Station-Id = "00-04-96-9b-5d-01"
(8)   NAS-Identifier = "X440G2-24t-10G4"
(8)   NAS-Port = 1005
(8)   NAS-Port-Type = Ethernet
(8)   Service-Type = Framed-User
(8)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(8)   EAP-Message = 0x0246000e01616e6f6e796d6f7573
(8)   Framed-MTU = 1300
(8) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(8)   authorize {
(8)     policy filter_username {
(8)       if (&User-Name) {
(8)       if (&User-Name)  -> TRUE
(8)       if (&User-Name)  {
(8)         if (&User-Name =~ / /) {
(8)         if (&User-Name =~ / /)  -> FALSE
(8)         if (&User-Name =~ /@[^@]*@/ ) {
(8)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(8)         if (&User-Name =~ /\.\./ ) {
(8)         if (&User-Name =~ /\.\./ )  -> FALSE
(8)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(8)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(8)         if (&User-Name =~ /\.$/)  {
(8)         if (&User-Name =~ /\.$/)   -> FALSE
(8)         if (&User-Name =~ /@\./)  {
(8)         if (&User-Name =~ /@\./)   -> FALSE
(8)       } # if (&User-Name)  = notfound
(8)     } # policy filter_username = notfound
(8)     [preprocess] = ok
(8)     [chap] = noop
(8)     [mschap] = noop
(8)     [digest] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)     [suffix] = noop
(8) eap: Peer sent EAP Response (code 2) ID 70 length 14
(8) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(8)     [eap] = ok
(8)   } # authorize = ok
(8) Found Auth-Type = eap
(8) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(8)   authenticate {
(8) eap: Peer sent packet with method EAP Identity (1)
(8) eap: Calling submodule eap_teap to process data
(8) eap_teap: (TLS) Initiating new session
(8) eap: Sending EAP Request (code 1) ID 71 length 18
(8) eap: EAP session adding &reply:State = 0x405d2b63401a1c39
(8)     [eap] = handled
(8)   } # authenticate = handled
(8) Using Post-Auth-Type Challenge
(8) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(8)   Challenge { ... } # empty sub-section is ignored
(8) session-state: Saving cached attributes
(8)   Framed-MTU = 984
(8) Sent Access-Challenge Id 133 from 10.54.27.54:1812 to 10.54.22.81:32769 length 76
(8)   EAP-Message = 0x014700123731000000080001000431323334
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0x405d2b63401a1c39e7001e2ea9a60c4c
(8) Finished request
Waking up in 4.9 seconds.
(9) Received Access-Request Id 134 from 10.54.22.81:32769 to 10.54.27.54:1812 length 316
(9)   Message-Authenticator = 0x68be4da917b6f4b84365fe5e880ed3b7
(9)   User-Name = "anonymous"
(9)   State = 0x405d2b63401a1c39e7001e2ea9a60c4c
(9)   NAS-IP-Address = 10.54.22.81
(9)   Called-Station-Id = "00-04-96-9b-5d-01"
(9)   NAS-Identifier = "X440G2-24t-10G4"
(9)   NAS-Port = 1005
(9)   NAS-Port-Type = Ethernet
(9)   Framed-MTU = 1300
(9)   Service-Type = Framed-User
(9)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(9)   EAP-Message = 0x024700a23701160303009701000093030363ef93c3fe6391585030eda0f3489dc67f9f305fdb596e8b6b10a6a5da9e48c3000024c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000046000500050100000000000a00080006001d00170018000b00020100000d001a00180804080508060401050102010403050302030202060106030023000000170000ff01000100
(9) Restoring &session-state
(9)   &session-state:Framed-MTU = 984
(9) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(9)   authorize {
(9)     policy filter_username {
(9)       if (&User-Name) {
(9)       if (&User-Name)  -> TRUE
(9)       if (&User-Name)  {
(9)         if (&User-Name =~ / /) {
(9)         if (&User-Name =~ / /)  -> FALSE
(9)         if (&User-Name =~ /@[^@]*@/ ) {
(9)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(9)         if (&User-Name =~ /\.\./ ) {
(9)         if (&User-Name =~ /\.\./ )  -> FALSE
(9)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(9)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(9)         if (&User-Name =~ /\.$/)  {
(9)         if (&User-Name =~ /\.$/)   -> FALSE
(9)         if (&User-Name =~ /@\./)  {
(9)         if (&User-Name =~ /@\./)   -> FALSE
(9)       } # if (&User-Name)  = notfound
(9)     } # policy filter_username = notfound
(9)     [preprocess] = ok
(9)     [chap] = noop
(9)     [mschap] = noop
(9)     [digest] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(9) suffix: No such realm "NULL"
(9)     [suffix] = noop
(9) eap: Peer sent EAP Response (code 2) ID 71 length 162
(9) eap: No EAP Start, assuming it's an on-going EAP conversation
(9)     [eap] = updated
(9)     [files] = noop
(9)     [expiration] = noop
(9)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(9)     [pap] = noop
(9)   } # authorize = updated
(9) Found Auth-Type = eap
(9) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(9)   authenticate {
(9) eap: Expiring EAP session with state 0x405d2b63401a1c39
(9) eap: Finished EAP session with state 0x405d2b63401a1c39
(9) eap: Previous EAP request found for state 0x405d2b63401a1c39, released from the list
(9) eap: Peer sent packet with method EAP TEAP (55)
(9) eap: Calling submodule eap_teap to process data
(9) eap_teap: Authenticate
(9) eap_teap: (TLS) EAP Got final fragment (156 bytes)
(9) eap_teap: WARNING: (TLS) EAP Total received record fragments (156 bytes), does not equal expected expected data length (0 bytes)
(9) eap_teap: (TLS) EAP Done initial handshake
(9) eap_teap: (TLS) Handshake state - before SSL initialization
(9) eap_teap: (TLS) Handshake state - Server before SSL initialization
(9) eap_teap: (TLS) Handshake state - Server before SSL initialization
(9) eap_teap: (TLS) recv TLS 1.3 Handshake, ClientHello
(9) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read client hello
(9) eap_teap: (TLS) send TLS 1.2 Handshake, ServerHello
(9) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server hello
(9) eap_teap: (TLS) send TLS 1.2 Handshake, Certificate
(9) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write certificate
(9) eap_teap: (TLS) send TLS 1.2 Handshake, ServerKeyExchange
(9) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write key exchange
(9) eap_teap: (TLS) send TLS 1.2 Handshake, ServerHelloDone
(9) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server done
(9) eap_teap: (TLS) Server : Need to read more data: SSLv3/TLS write server done
(9) eap_teap: (TLS) In Handshake Phase
(9) eap: Sending EAP Request (code 1) ID 72 length 994
(9) eap: EAP session adding &reply:State = 0x405d2b6341151c39
(9)     [eap] = handled
(9)   } # authenticate = handled
(9) Using Post-Auth-Type Challenge
(9) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(9)   Challenge { ... } # empty sub-section is ignored
(9) session-state: Saving cached attributes
(9)   Framed-MTU = 984
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(9)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(9)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(9)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(9)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(9) Sent Access-Challenge Id 134 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1058
(9)   EAP-Message = 0x014803e237c100000cc5160303003d02000039030329a743dabf4d7161fc6404e19302ec7b0caadf18e2e69b3439123ce2bafad4b500c030000011ff01000100000b000403000102001700001603030a440b000a40000a3d00068b308206873082056fa0030201020213190000002839d906f0560dcaa7000200000028300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3232313230373134303232325a170d3234313230363134303232325a306a310b3009060355040613025553310b3009060355040813024e48311430120603550407130b4c6f6e646f6e6465727279310a3008060355040a130141310a3008060355040b1301443120301e060355040313174e41432d323137312e657874727161323031322e636f6d30820222300d06092a86
(9)   Message-Authenticator = 0x00000000000000000000000000000000
(9)   State = 0x405d2b6341151c39e7001e2ea9a60c4c
(9) Finished request
Waking up in 4.9 seconds.
(10) Received Access-Request Id 135 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(10)   Message-Authenticator = 0xa0f3b9378d6f80c0108e80fe06982b68
(10)   User-Name = "anonymous"
(10)   State = 0x405d2b6341151c39e7001e2ea9a60c4c
(10)   NAS-IP-Address = 10.54.22.81
(10)   Called-Station-Id = "00-04-96-9b-5d-01"
(10)   NAS-Identifier = "X440G2-24t-10G4"
(10)   NAS-Port = 1005
(10)   NAS-Port-Type = Ethernet
(10)   Framed-MTU = 1300
(10)   Service-Type = Framed-User
(10)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(10)   EAP-Message = 0x024800063701
(10) Restoring &session-state
(10)   &session-state:Framed-MTU = 984
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(10) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(10)   authorize {
(10)     policy filter_username {
(10)       if (&User-Name) {
(10)       if (&User-Name)  -> TRUE
(10)       if (&User-Name)  {
(10)         if (&User-Name =~ / /) {
(10)         if (&User-Name =~ / /)  -> FALSE
(10)         if (&User-Name =~ /@[^@]*@/ ) {
(10)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(10)         if (&User-Name =~ /\.\./ ) {
(10)         if (&User-Name =~ /\.\./ )  -> FALSE
(10)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(10)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(10)         if (&User-Name =~ /\.$/)  {
(10)         if (&User-Name =~ /\.$/)   -> FALSE
(10)         if (&User-Name =~ /@\./)  {
(10)         if (&User-Name =~ /@\./)   -> FALSE
(10)       } # if (&User-Name)  = notfound
(10)     } # policy filter_username = notfound
(10)     [preprocess] = ok
(10)     [chap] = noop
(10)     [mschap] = noop
(10)     [digest] = noop
(10) suffix: Checking for suffix after "@"
(10) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(10) suffix: No such realm "NULL"
(10)     [suffix] = noop
(10) eap: Peer sent EAP Response (code 2) ID 72 length 6
(10) eap: No EAP Start, assuming it's an on-going EAP conversation
(10)     [eap] = updated
(10)     [files] = noop
(10)     [expiration] = noop
(10)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(10)     [pap] = noop
(10)   } # authorize = updated
(10) Found Auth-Type = eap
(10) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(10)   authenticate {
(10) eap: Expiring EAP session with state 0x405d2b6341151c39
(10) eap: Finished EAP session with state 0x405d2b6341151c39
(10) eap: Previous EAP request found for state 0x405d2b6341151c39, released from the list
(10) eap: Peer sent packet with method EAP TEAP (55)
(10) eap: Calling submodule eap_teap to process data
(10) eap_teap: Authenticate
(10) eap_teap: (TLS) Peer ACKed our handshake fragment
(10) eap: Sending EAP Request (code 1) ID 73 length 990
(10) eap: EAP session adding &reply:State = 0x405d2b6342141c39
(10)     [eap] = handled
(10)   } # authenticate = handled
(10) Using Post-Auth-Type Challenge
(10) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(10)   Challenge { ... } # empty sub-section is ignored
(10) session-state: Saving cached attributes
(10)   Framed-MTU = 984
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(10)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(10)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(10)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(10)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(10) Sent Access-Challenge Id 135 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1054
(10)   EAP-Message = 0x014903de37411f0481d53081d23081cfa081cca081c98681c66c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412831292c434e3d57494e3230313252322c434e3d4344502c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d455854525141323031322c44433d636f6d3f63657274696669636174655265766f636174696f6e4c6973743f626173653f6f626a656374436c6173733d63524c446973747269627574696f6e506f696e743081cc06082b060105050701010481bf3081bc3081b906082b060105050730028681ac6c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412c434e3d4149412c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d455854525141323031322c44433d636f
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   State = 0x405d2b6342141c39e7001e2ea9a60c4c
(10) Finished request
Waking up in 4.9 seconds.
(11) Received Access-Request Id 136 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(11)   Message-Authenticator = 0x527abd0fef71c896937a481240c0c52e
(11)   User-Name = "anonymous"
(11)   State = 0x405d2b6342141c39e7001e2ea9a60c4c
(11)   NAS-IP-Address = 10.54.22.81
(11)   Called-Station-Id = "00-04-96-9b-5d-01"
(11)   NAS-Identifier = "X440G2-24t-10G4"
(11)   NAS-Port = 1005
(11)   NAS-Port-Type = Ethernet
(11)   Framed-MTU = 1300
(11)   Service-Type = Framed-User
(11)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(11)   EAP-Message = 0x024900063701
(11) Restoring &session-state
(11)   &session-state:Framed-MTU = 984
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(11) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(11)   authorize {
(11)     policy filter_username {
(11)       if (&User-Name) {
(11)       if (&User-Name)  -> TRUE
(11)       if (&User-Name)  {
(11)         if (&User-Name =~ / /) {
(11)         if (&User-Name =~ / /)  -> FALSE
(11)         if (&User-Name =~ /@[^@]*@/ ) {
(11)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(11)         if (&User-Name =~ /\.\./ ) {
(11)         if (&User-Name =~ /\.\./ )  -> FALSE
(11)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(11)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(11)         if (&User-Name =~ /\.$/)  {
(11)         if (&User-Name =~ /\.$/)   -> FALSE
(11)         if (&User-Name =~ /@\./)  {
(11)         if (&User-Name =~ /@\./)   -> FALSE
(11)       } # if (&User-Name)  = notfound
(11)     } # policy filter_username = notfound
(11)     [preprocess] = ok
(11)     [chap] = noop
(11)     [mschap] = noop
(11)     [digest] = noop
(11) suffix: Checking for suffix after "@"
(11) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(11) suffix: No such realm "NULL"
(11)     [suffix] = noop
(11) eap: Peer sent EAP Response (code 2) ID 73 length 6
(11) eap: No EAP Start, assuming it's an on-going EAP conversation
(11)     [eap] = updated
(11)     [files] = noop
(11)     [expiration] = noop
(11)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(11)     [pap] = noop
(11)   } # authorize = updated
(11) Found Auth-Type = eap
(11) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(11)   authenticate {
(11) eap: Expiring EAP session with state 0x405d2b6342141c39
(11) eap: Finished EAP session with state 0x405d2b6342141c39
(11) eap: Previous EAP request found for state 0x405d2b6342141c39, released from the list
(11) eap: Peer sent packet with method EAP TEAP (55)
(11) eap: Calling submodule eap_teap to process data
(11) eap_teap: Authenticate
(11) eap_teap: (TLS) Peer ACKed our handshake fragment
(11) eap: Sending EAP Request (code 1) ID 74 length 990
(11) eap: EAP session adding &reply:State = 0x405d2b6343171c39
(11)     [eap] = handled
(11)   } # authenticate = handled
(11) Using Post-Auth-Type Challenge
(11) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(11)   Challenge { ... } # empty sub-section is ignored
(11) session-state: Saving cached attributes
(11)   Framed-MTU = 984
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(11)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(11)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(11)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(11)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(11) Sent Access-Challenge Id 136 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1054
(11)   EAP-Message = 0x014a03de374141323031323120301e06035504031317455854525141323031322d57494e3230313252322d434130820122300d06092a864886f70d01010105000382010f003082010a0282010100c5df228307acbda10e7e7882c15e8a14c74a3e7cf71f3a17562359b95b367af7d7b94dd2f8f9b34a252105f55b39a8882a46ba6b8cfa91a89cea9fcdc949bff239927510d1e18b48bed184412961076e535744fed109eaf694efbc4c5c56baff4c1a849dc4757341c1bf15f0c021488ea1a8b67f07e2d1670325a40e432f22e3dabb2069247eef899ca879a2273a918f5028cf016673ea2b970735b5b585d92b6a80526fec3cea7f6465e42e400a02423fb2693b7cc1d98f6ed644c5d2af8233a81c1217f13683797079b493c51c4a1f5b0abd5276eeaf0e247a4c7e9a292496b297df42d15a5709ccdfe17608afab92278650b3d769231a49c131608c8f8c290203010001a3783076300b0603551d0f040403020186300f0603551d130101ff040530030101ff301d
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0x405d2b6343171c39e7001e2ea9a60c4c
(11) Finished request
Waking up in 4.9 seconds.
(12) Received Access-Request Id 137 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(12)   Message-Authenticator = 0x3cc0bcf17c12b71cd54b76a3acef47e6
(12)   User-Name = "anonymous"
(12)   State = 0x405d2b6343171c39e7001e2ea9a60c4c
(12)   NAS-IP-Address = 10.54.22.81
(12)   Called-Station-Id = "00-04-96-9b-5d-01"
(12)   NAS-Identifier = "X440G2-24t-10G4"
(12)   NAS-Port = 1005
(12)   NAS-Port-Type = Ethernet
(12)   Framed-MTU = 1300
(12)   Service-Type = Framed-User
(12)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(12)   EAP-Message = 0x024a00063701
(12) Restoring &session-state
(12)   &session-state:Framed-MTU = 984
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(12) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(12)   authorize {
(12)     policy filter_username {
(12)       if (&User-Name) {
(12)       if (&User-Name)  -> TRUE
(12)       if (&User-Name)  {
(12)         if (&User-Name =~ / /) {
(12)         if (&User-Name =~ / /)  -> FALSE
(12)         if (&User-Name =~ /@[^@]*@/ ) {
(12)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(12)         if (&User-Name =~ /\.\./ ) {
(12)         if (&User-Name =~ /\.\./ )  -> FALSE
(12)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(12)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(12)         if (&User-Name =~ /\.$/)  {
(12)         if (&User-Name =~ /\.$/)   -> FALSE
(12)         if (&User-Name =~ /@\./)  {
(12)         if (&User-Name =~ /@\./)   -> FALSE
(12)       } # if (&User-Name)  = notfound
(12)     } # policy filter_username = notfound
(12)     [preprocess] = ok
(12)     [chap] = noop
(12)     [mschap] = noop
(12)     [digest] = noop
(12) suffix: Checking for suffix after "@"
(12) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(12) suffix: No such realm "NULL"
(12)     [suffix] = noop
(12) eap: Peer sent EAP Response (code 2) ID 74 length 6
(12) eap: No EAP Start, assuming it's an on-going EAP conversation
(12)     [eap] = updated
(12)     [files] = noop
(12)     [expiration] = noop
(12)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(12)     [pap] = noop
(12)   } # authorize = updated
(12) Found Auth-Type = eap
(12) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(12)   authenticate {
(12) eap: Expiring EAP session with state 0x405d2b6343171c39
(12) eap: Finished EAP session with state 0x405d2b6343171c39
(12) eap: Previous EAP request found for state 0x405d2b6343171c39, released from the list
(12) eap: Peer sent packet with method EAP TEAP (55)
(12) eap: Calling submodule eap_teap to process data
(12) eap_teap: Authenticate
(12) eap_teap: (TLS) Peer ACKed our handshake fragment
(12) eap: Sending EAP Request (code 1) ID 75 length 323
(12) eap: EAP session adding &reply:State = 0x405d2b6344161c39
(12)     [eap] = handled
(12)   } # authenticate = handled
(12) Using Post-Auth-Type Challenge
(12) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(12)   Challenge { ... } # empty sub-section is ignored
(12) session-state: Saving cached attributes
(12)   Framed-MTU = 984
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(12)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(12)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(12)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(12)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(12) Sent Access-Challenge Id 137 from 10.54.27.54:1812 to 10.54.22.81:32769 length 383
(12)   EAP-Message = 0x014b0143370169502c683da5fac9b2ac705c52cf59e1c4d4c09bb0a293e1c170200c24ab0f1723954d9c0dce66ee683dd18e95996a517dd56fad1ddca94557ff45e952841e06022f7bd3b489ebbb12d9731878612d0ec8038244ff88b5ec2451a989980f50d8643209acc3a87a6dec00a9b7d6b3a1d0de70345fb7aea7971b4f67469c3b66eece1e2d21e5cbe79661154678ede8832d68d62e8d392174e5f20b8c4177312de57e00242ea62865d27eab5440428675d484831ec030e62a34b08936ceb1599564809860916193013890f6b2d5ae53b0bd9b9dc9e1e481ddb1d23480f437b055f51497ae30c5988ec98d1fa7444522879c79aaaa8bd4fa136685e042f0d8ee30082f54d0a2b42de4fef46c457080c9c28c4d1aa4adfb677644274e0c4fcbccb8b12944c67097ec597319f20015b54eadd057af2b4516030300040e000000
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0x405d2b6344161c39e7001e2ea9a60c4c
(12) Finished request
Waking up in 4.9 seconds.
(13) Received Access-Request Id 138 from 10.54.22.81:32769 to 10.54.27.54:1812 length 253
(13)   Message-Authenticator = 0xab358e42a4d324f4897f24cbaa6a13ef
(13)   User-Name = "anonymous"
(13)   State = 0x405d2b6344161c39e7001e2ea9a60c4c
(13)   NAS-IP-Address = 10.54.22.81
(13)   Called-Station-Id = "00-04-96-9b-5d-01"
(13)   NAS-Identifier = "X440G2-24t-10G4"
(13)   NAS-Port = 1005
(13)   NAS-Port-Type = Ethernet
(13)   Framed-MTU = 1300
(13)   Service-Type = Framed-User
(13)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(13)   EAP-Message = 0x024b0063370116030300251000002120314b94f3cc7f5874c0ab58e11e3509af1d5acf2724b4f8f8e1519f662fc09c0d14030300010116030300280000000000000000776c0e7bb80e5eb783fe23ab871c98b219c5579c9ee5f81bb278f1a14f6d0678
(13) Restoring &session-state
(13)   &session-state:Framed-MTU = 984
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(13) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(13)   authorize {
(13)     policy filter_username {
(13)       if (&User-Name) {
(13)       if (&User-Name)  -> TRUE
(13)       if (&User-Name)  {
(13)         if (&User-Name =~ / /) {
(13)         if (&User-Name =~ / /)  -> FALSE
(13)         if (&User-Name =~ /@[^@]*@/ ) {
(13)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(13)         if (&User-Name =~ /\.\./ ) {
(13)         if (&User-Name =~ /\.\./ )  -> FALSE
(13)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(13)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(13)         if (&User-Name =~ /\.$/)  {
(13)         if (&User-Name =~ /\.$/)   -> FALSE
(13)         if (&User-Name =~ /@\./)  {
(13)         if (&User-Name =~ /@\./)   -> FALSE
(13)       } # if (&User-Name)  = notfound
(13)     } # policy filter_username = notfound
(13)     [preprocess] = ok
(13)     [chap] = noop
(13)     [mschap] = noop
(13)     [digest] = noop
(13) suffix: Checking for suffix after "@"
(13) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(13) suffix: No such realm "NULL"
(13)     [suffix] = noop
(13) eap: Peer sent EAP Response (code 2) ID 75 length 99
(13) eap: No EAP Start, assuming it's an on-going EAP conversation
(13)     [eap] = updated
(13)     [files] = noop
(13)     [expiration] = noop
(13)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(13)     [pap] = noop
(13)   } # authorize = updated
(13) Found Auth-Type = eap
(13) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(13)   authenticate {
(13) eap: Expiring EAP session with state 0x405d2b6344161c39
(13) eap: Finished EAP session with state 0x405d2b6344161c39
(13) eap: Previous EAP request found for state 0x405d2b6344161c39, released from the list
(13) eap: Peer sent packet with method EAP TEAP (55)
(13) eap: Calling submodule eap_teap to process data
(13) eap_teap: Authenticate
(13) eap_teap: (TLS) EAP Done initial handshake
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write server done
(13) eap_teap: (TLS) recv TLS 1.2 Handshake, ClientKeyExchange
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read client key exchange
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read change cipher spec
(13) eap_teap: (TLS) recv TLS 1.2 Handshake, Finished
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS read finished
(13) eap_teap: (TLS) send TLS 1.2 ChangeCipherSpec
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write change cipher spec
(13) eap_teap: (TLS) send TLS 1.2 Handshake, Finished
(13) eap_teap: (TLS) Handshake state - Server SSLv3/TLS write finished
(13) eap_teap: (TLS) Handshake state - SSL negotiation finished successfully
(13) eap_teap: (TLS) Connection Established
(13) eap_teap:   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(13) eap_teap:   TLS-Session-Version = "TLS 1.2"
(13) eap: Sending EAP Request (code 1) ID 76 length 57
(13) eap: EAP session adding &reply:State = 0x405d2b6345111c39
(13)     [eap] = handled
(13)   } # authenticate = handled
(13) Using Post-Auth-Type Challenge
(13) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(13)   Challenge { ... } # empty sub-section is ignored
(13) session-state: Saving cached attributes
(13)   Framed-MTU = 984
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(13)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(13)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(13)   TLS-Session-Version = "TLS 1.2"
(13) Sent Access-Challenge Id 138 from 10.54.27.54:1812 to 10.54.22.81:32769 length 115
(13)   EAP-Message = 0x014c003937011403030001011603030028aa281f61c0bb6307f3b889a4c8b250bc1d51217a01f6afd318a34944b6c932db0e733b9fb169dbf8
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0x405d2b6345111c39e7001e2ea9a60c4c
(13) Finished request
Waking up in 4.9 seconds.
(14) Received Access-Request Id 139 from 10.54.22.81:32769 to 10.54.27.54:1812 length 160
(14)   Message-Authenticator = 0xc2b74e87250880479992e4616c22575e
(14)   User-Name = "anonymous"
(14)   State = 0x405d2b6345111c39e7001e2ea9a60c4c
(14)   NAS-IP-Address = 10.54.22.81
(14)   Called-Station-Id = "00-04-96-9b-5d-01"
(14)   NAS-Identifier = "X440G2-24t-10G4"
(14)   NAS-Port = 1005
(14)   NAS-Port-Type = Ethernet
(14)   Framed-MTU = 1300
(14)   Service-Type = Framed-User
(14)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(14)   EAP-Message = 0x024c00063701
(14) Restoring &session-state
(14)   &session-state:Framed-MTU = 984
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(14)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(14)   &session-state:TLS-Session-Version = "TLS 1.2"
(14) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(14)   authorize {
(14)     policy filter_username {
(14)       if (&User-Name) {
(14)       if (&User-Name)  -> TRUE
(14)       if (&User-Name)  {
(14)         if (&User-Name =~ / /) {
(14)         if (&User-Name =~ / /)  -> FALSE
(14)         if (&User-Name =~ /@[^@]*@/ ) {
(14)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(14)         if (&User-Name =~ /\.\./ ) {
(14)         if (&User-Name =~ /\.\./ )  -> FALSE
(14)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(14)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(14)         if (&User-Name =~ /\.$/)  {
(14)         if (&User-Name =~ /\.$/)   -> FALSE
(14)         if (&User-Name =~ /@\./)  {
(14)         if (&User-Name =~ /@\./)   -> FALSE
(14)       } # if (&User-Name)  = notfound
(14)     } # policy filter_username = notfound
(14)     [preprocess] = ok
(14)     [chap] = noop
(14)     [mschap] = noop
(14)     [digest] = noop
(14) suffix: Checking for suffix after "@"
(14) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(14) suffix: No such realm "NULL"
(14)     [suffix] = noop
(14) eap: Peer sent EAP Response (code 2) ID 76 length 6
(14) eap: No EAP Start, assuming it's an on-going EAP conversation
(14)     [eap] = updated
(14)     [files] = noop
(14)     [expiration] = noop
(14)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(14)     [pap] = noop
(14)   } # authorize = updated
(14) Found Auth-Type = eap
(14) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(14)   authenticate {
(14) eap: Expiring EAP session with state 0x405d2b6345111c39
(14) eap: Finished EAP session with state 0x405d2b6345111c39
(14) eap: Previous EAP request found for state 0x405d2b6345111c39, released from the list
(14) eap: Peer sent packet with method EAP TEAP (55)
(14) eap: Calling submodule eap_teap to process data
(14) eap_teap: Authenticate
(14) eap_teap: (TLS) Peer ACKed our handshake fragment.  handshake is finished
(14) eap_teap: Session established.  Proceeding to decode tunneled attributes
(14) eap_teap: Using authenticated provisioning
(14) eap_teap: Using MAC SHA384 (673)
(14) eap_teap: Deriving EAP-TEAP keys
(14) eap_teap: S-IMCK[0] - hexdump(len=40): c7 b4 c7 55 84 ad c0 75 13 31 a5 c5 ac 6f fd 9d ff dc 8a 60 70 9f b0 54 d6 74 09 e2 9f a8 91 6c 2f 19 81 af ce ab a1 59
(14) eap_teap: Sending EAP-Identity
(14) eap: Sending EAP Request (code 1) ID 77 length 44
(14) eap: EAP session adding &reply:State = 0x405d2b6346101c39
(14)     [eap] = handled
(14)   } # authenticate = handled
(14) Using Post-Auth-Type Challenge
(14) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(14)   Challenge { ... } # empty sub-section is ignored
(14) session-state: Saving cached attributes
(14)   Framed-MTU = 984
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(14)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(14)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(14)   TLS-Session-Version = "TLS 1.2"
(14) Sent Access-Challenge Id 139 from 10.54.27.54:1812 to 10.54.22.81:32769 length 102
(14)   EAP-Message = 0x014d002c37011703030021aa281f61c0bb630805a7d972f7290efa681f45f54c54492de6a4d520a12f84b980
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   State = 0x405d2b6346101c39e7001e2ea9a60c4c
(14) Finished request
Waking up in 4.9 seconds.
(15) Received Access-Request Id 140 from 10.54.22.81:32769 to 10.54.27.54:1812 length 222
(15)   Message-Authenticator = 0x50b00dea7f448f939fc47119396f29d5
(15)   User-Name = "anonymous"
(15)   State = 0x405d2b6346101c39e7001e2ea9a60c4c
(15)   NAS-IP-Address = 10.54.22.81
(15)   Called-Station-Id = "00-04-96-9b-5d-01"
(15)   NAS-Identifier = "X440G2-24t-10G4"
(15)   NAS-Port = 1005
(15)   NAS-Port-Type = Ethernet
(15)   Framed-MTU = 1300
(15)   Service-Type = Framed-User
(15)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(15)   EAP-Message = 0x024d0044370117030300390000000000000001bc03287f834115336372d8e26e20848e58f7946035e6a6d289d0b3f13644d96c10bffecd7ac9a51aef9eda1d0342b8eef2
(15) Restoring &session-state
(15)   &session-state:Framed-MTU = 984
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(15)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(15)   &session-state:TLS-Session-Version = "TLS 1.2"
(15) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(15)   authorize {
(15)     policy filter_username {
(15)       if (&User-Name) {
(15)       if (&User-Name)  -> TRUE
(15)       if (&User-Name)  {
(15)         if (&User-Name =~ / /) {
(15)         if (&User-Name =~ / /)  -> FALSE
(15)         if (&User-Name =~ /@[^@]*@/ ) {
(15)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(15)         if (&User-Name =~ /\.\./ ) {
(15)         if (&User-Name =~ /\.\./ )  -> FALSE
(15)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(15)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(15)         if (&User-Name =~ /\.$/)  {
(15)         if (&User-Name =~ /\.$/)   -> FALSE
(15)         if (&User-Name =~ /@\./)  {
(15)         if (&User-Name =~ /@\./)   -> FALSE
(15)       } # if (&User-Name)  = notfound
(15)     } # policy filter_username = notfound
(15)     [preprocess] = ok
(15)     [chap] = noop
(15)     [mschap] = noop
(15)     [digest] = noop
(15) suffix: Checking for suffix after "@"
(15) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(15) suffix: No such realm "NULL"
(15)     [suffix] = noop
(15) eap: Peer sent EAP Response (code 2) ID 77 length 68
(15) eap: No EAP Start, assuming it's an on-going EAP conversation
(15)     [eap] = updated
(15)     [files] = noop
(15)     [expiration] = noop
(15)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(15)     [pap] = noop
(15)   } # authorize = updated
(15) Found Auth-Type = eap
(15) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(15)   authenticate {
(15) eap: Expiring EAP session with state 0x405d2b6346101c39
(15) eap: Finished EAP session with state 0x405d2b6346101c39
(15) eap: Previous EAP request found for state 0x405d2b6346101c39, released from the list
(15) eap: Peer sent packet with method EAP TEAP (55)
(15) eap: Calling submodule eap_teap to process data
(15) eap_teap: Authenticate
(15) eap_teap: (TLS) EAP Done initial handshake
(15) eap_teap: Session established.  Proceeding to decode tunneled attributes
(15) eap_teap: Got Tunneled TEAP TLVs
(15) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x024d001d0177696e31317465617040455854525141323031322e636f6d
(15) eap_teap: Processing received EAP Payload
(15) eap_teap: Got tunneled request
(15) eap_teap:   EAP-Message = 0x024d001d0177696e31317465617040455854525141323031322e636f6d
(15) eap_teap: Got tunneled identity of win11teap@EXTRQA2012.com
(15) eap_teap: AUTHENTICATION
(15) Virtual server inner-tunnel received request
(15)   EAP-Message = 0x024d001d0177696e31317465617040455854525141323031322e636f6d
(15)   FreeRADIUS-Proxied-To = 127.0.0.1
(15)   User-Name = "win11teap@EXTRQA2012.com"
(15) server inner-tunnel {
(15)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(15)     authorize {
(15)       policy filter_username {
(15)         if (&User-Name) {
(15)         if (&User-Name)  -> TRUE
(15)         if (&User-Name)  {
(15)           if (&User-Name =~ / /) {
(15)           if (&User-Name =~ / /)  -> FALSE
(15)           if (&User-Name =~ /@[^@]*@/ ) {
(15)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(15)           if (&User-Name =~ /\.\./ ) {
(15)           if (&User-Name =~ /\.\./ )  -> FALSE
(15)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(15)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(15)           if (&User-Name =~ /\.$/)  {
(15)           if (&User-Name =~ /\.$/)   -> FALSE
(15)           if (&User-Name =~ /@\./)  {
(15)           if (&User-Name =~ /@\./)   -> FALSE
(15)         } # if (&User-Name)  = notfound
(15)       } # policy filter_username = notfound
(15)       [chap] = noop
(15)       [mschap] = noop
(15) suffix: Checking for suffix after "@"
(15) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(15) suffix: No such realm "EXTRQA2012.com"
(15)       [suffix] = noop
(15)       update control {
(15)         &Proxy-To-Realm := LOCAL
(15)       } # update control = noop
(15)       if (&outer.request:EAP-Type == TEAP) {
(15)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(15)       if (&outer.request:EAP-Type == TEAP)  {
(15)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(15)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(15)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(15)           update reply {
(15)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(15)           } # update reply = noop
(15)           update session-state {
(15)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(15)           } # update session-state = noop
(15)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(15)         ... skipping elsif: Preceding "if" was taken
(15) eap: Peer sent EAP Response (code 2) ID 77 length 29
(15) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(15)         [eap] = ok
(15)         if (ok) {
(15)         if (ok)  -> TRUE
(15)         if (ok)  {
(15)           update config {
(15)             &Auth-Type := TEAP
(15)           } # update config = noop
(15)           return
(15)         } # if (ok)  = noop
(15)       } # if (&outer.request:EAP-Type == TEAP)  = ok
(15)     } # authorize = ok
(15)   Found Auth-Type = TEAP
(15)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(15)     Auth-Type TEAP {
(15)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(15)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(15)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(15)         update control {
(15)           &EAP-Type := TLS
(15)         } # update control = noop
(15)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(15)       ... skipping elsif: Preceding "if" was taken
(15) eap: Peer sent packet with method EAP Identity (1)
(15) eap: Calling submodule eap_tls to process data
(15) eap_tls: (TLS) Initiating new session
(15) eap_tls: (TLS) Setting verify mode to require certificate from client
(15) eap: Sending EAP Request (code 1) ID 78 length 10
(15) eap: EAP session adding &reply:State = 0xb17fba92b131b7f7
(15)       [eap] = handled
(15)     } # Auth-Type TEAP = handled
(15) } # server inner-tunnel
(15) Virtual server sending reply
(15)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(15)   EAP-Message = 0x014e000a0da000000000
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15)   State = 0xb17fba92b131b7f706ab2fe838072b73
(15) eap_teap: Got tunneled Access-Challenge
(15) eap: Sending EAP Request (code 1) ID 78 length 49
(15) eap: EAP session adding &reply:State = 0x405d2b6347131c39
(15)     [eap] = handled
(15)   } # authenticate = handled
(15) Using Post-Auth-Type Challenge
(15) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(15)   Challenge { ... } # empty sub-section is ignored
(15) session-state: Saving cached attributes
(15)   Framed-MTU = 984
(15)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(15)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(15)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(15)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(15)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(15)   TLS-Session-Version = "TLS 1.2"
(15) Sent Access-Challenge Id 140 from 10.54.27.54:1812 to 10.54.22.81:32769 length 107
(15)   EAP-Message = 0x014e003137011703030026aa281f61c0bb630919ed2e63a7efdd6a95868bb8c79fd0ea97a239c8aac5cc3adf0af82cd70c
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15)   State = 0x405d2b6347131c39e7001e2ea9a60c4c
(15) Finished request
Waking up in 4.8 seconds.
(16) Received Access-Request Id 141 from 10.54.22.81:32769 to 10.54.27.54:1812 length 456
(16)   Message-Authenticator = 0xc9c9614991c02737b1b6591ee17e574e
(16)   User-Name = "anonymous"
(16)   State = 0x405d2b6347131c39e7001e2ea9a60c4c
(16)   NAS-IP-Address = 10.54.22.81
(16)   Called-Station-Id = "00-04-96-9b-5d-01"
(16)   NAS-Identifier = "X440G2-24t-10G4"
(16)   NAS-Port = 1005
(16)   NAS-Port-Type = Ethernet
(16)   Framed-MTU = 1300
(16)   Service-Type = Framed-User
(16)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(16)   EAP-Message = 0x024e012c3701170303012100000000000000023c238a70a65ac294d440c980c26e038326374f4f3f6467d56ff565921bd4ceb66223c232b57cd3c0846a71087e5c80a99ad3c58bfafeb4baeefa4a4b20e7e59fab91b6d9d7c32c472435abb4244ce4b99b07bfe2f44a62f1cf808564cd79ef82e46af530bdfe017b5fa9b57b8e60c096bcc59529cff74486597f6e98de6e4785d65119d2b27e41d2f79286a66ab020271d55383897ae0884457fec4667a61de7123a859b2144916116b4edb1952bb1b670378e5e3bdabcb72795aef4cb0ee44958a06ab252a43103aecf67bd8f2ddf8003df58792071648d8e322dcb9603d785ad55c209a2749f25209728972547e4baf8ffdbff1403c1322b4c8f3da9db3ec1896de8c64bb5c9ad5f6c1b9349b15b02691447ec13397ebbe3
(16) Restoring &session-state
(16)   &session-state:Framed-MTU = 984
(16)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(16)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(16)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(16)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(16)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(16)   &session-state:TLS-Session-Version = "TLS 1.2"
(16) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(16)   authorize {
(16)     policy filter_username {
(16)       if (&User-Name) {
(16)       if (&User-Name)  -> TRUE
(16)       if (&User-Name)  {
(16)         if (&User-Name =~ / /) {
(16)         if (&User-Name =~ / /)  -> FALSE
(16)         if (&User-Name =~ /@[^@]*@/ ) {
(16)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(16)         if (&User-Name =~ /\.\./ ) {
(16)         if (&User-Name =~ /\.\./ )  -> FALSE
(16)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(16)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(16)         if (&User-Name =~ /\.$/)  {
(16)         if (&User-Name =~ /\.$/)   -> FALSE
(16)         if (&User-Name =~ /@\./)  {
(16)         if (&User-Name =~ /@\./)   -> FALSE
(16)       } # if (&User-Name)  = notfound
(16)     } # policy filter_username = notfound
(16)     [preprocess] = ok
(16)     [chap] = noop
(16)     [mschap] = noop
(16)     [digest] = noop
(16) suffix: Checking for suffix after "@"
(16) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(16) suffix: No such realm "NULL"
(16)     [suffix] = noop
(16) eap: Peer sent EAP Response (code 2) ID 78 length 300
(16) eap: No EAP Start, assuming it's an on-going EAP conversation
(16)     [eap] = updated
(16)     [files] = noop
(16)     [expiration] = noop
(16)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(16)     [pap] = noop
(16)   } # authorize = updated
(16) Found Auth-Type = eap
(16) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(16)   authenticate {
(16) eap: Expiring EAP session with state 0xb17fba92b131b7f7
(16) eap: Finished EAP session with state 0x405d2b6347131c39
(16) eap: Previous EAP request found for state 0x405d2b6347131c39, released from the list
(16) eap: Peer sent packet with method EAP TEAP (55)
(16) eap: Calling submodule eap_teap to process data
(16) eap_teap: Authenticate
(16) eap_teap: (TLS) EAP Done initial handshake
(16) eap_teap: Session established.  Proceeding to decode tunneled attributes
(16) eap_teap: Got Tunneled TEAP TLVs
(16) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x024e01050d80000000fb16030100f6010000f203038dfb3c90a2742d5dc913f5713ee7cc6bd927ec8f95dd2f2d6d898b0b21b29864204be4a81a015ed295dde3c7b43fef6517757556d71dcba7bab7fa97c38cf96b29002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d0020d055ff336f9aded5199d14bde1e8c7e09dcfa92ac76f544dec7529f5bd4a6a500031000000170000ff01000100002d00020101
(16) eap_teap: Processing received EAP Payload
(16) eap_teap: Got tunneled request
(16) eap_teap:   EAP-Message = 0x024e01050d80000000fb16030100f6010000f203038dfb3c90a2742d5dc913f5713ee7cc6bd927ec8f95dd2f2d6d898b0b21b29864204be4a81a015ed295dde3c7b43fef6517757556d71dcba7bab7fa97c38cf96b29002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d0020d055ff336f9aded5199d14bde1e8c7e09dcfa92ac76f544dec7529f5bd4a6a500031000000170000ff01000100002d00020101
(16) eap_teap: AUTHENTICATION
(16) Virtual server inner-tunnel received request
(16)   EAP-Message = 0x024e01050d80000000fb16030100f6010000f203038dfb3c90a2742d5dc913f5713ee7cc6bd927ec8f95dd2f2d6d898b0b21b29864204be4a81a015ed295dde3c7b43fef6517757556d71dcba7bab7fa97c38cf96b29002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d0020d055ff336f9aded5199d14bde1e8c7e09dcfa92ac76f544dec7529f5bd4a6a500031000000170000ff01000100002d00020101
(16)   FreeRADIUS-Proxied-To = 127.0.0.1
(16)   User-Name = "win11teap@EXTRQA2012.com"
(16)   State = 0xb17fba92b131b7f706ab2fe838072b73
(16) server inner-tunnel {
(16)   session-state: No cached attributes
(16)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(16)     authorize {
(16)       policy filter_username {
(16)         if (&User-Name) {
(16)         if (&User-Name)  -> TRUE
(16)         if (&User-Name)  {
(16)           if (&User-Name =~ / /) {
(16)           if (&User-Name =~ / /)  -> FALSE
(16)           if (&User-Name =~ /@[^@]*@/ ) {
(16)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(16)           if (&User-Name =~ /\.\./ ) {
(16)           if (&User-Name =~ /\.\./ )  -> FALSE
(16)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(16)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(16)           if (&User-Name =~ /\.$/)  {
(16)           if (&User-Name =~ /\.$/)   -> FALSE
(16)           if (&User-Name =~ /@\./)  {
(16)           if (&User-Name =~ /@\./)   -> FALSE
(16)         } # if (&User-Name)  = notfound
(16)       } # policy filter_username = notfound
(16)       [chap] = noop
(16)       [mschap] = noop
(16) suffix: Checking for suffix after "@"
(16) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(16) suffix: No such realm "EXTRQA2012.com"
(16)       [suffix] = noop
(16)       update control {
(16)         &Proxy-To-Realm := LOCAL
(16)       } # update control = noop
(16)       if (&outer.request:EAP-Type == TEAP) {
(16)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(16)       if (&outer.request:EAP-Type == TEAP)  {
(16)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(16)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(16)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(16)           update reply {
(16)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(16)           } # update reply = noop
(16)           update session-state {
(16)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(16)           } # update session-state = noop
(16)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(16)         ... skipping elsif: Preceding "if" was taken
(16) eap: Peer sent EAP Response (code 2) ID 78 length 261
(16) eap: No EAP Start, assuming it's an on-going EAP conversation
(16)         [eap] = updated
(16)         if (ok) {
(16)         if (ok)  -> FALSE
(16)         update config {
(16)           &Auth-Type := TEAP
(16)         } # update config = noop
(16)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(16)       [files] = noop
(16)       [expiration] = noop
(16)       [logintime] = noop
(16)       [pap] = noop
(16)     } # authorize = updated
(16)   Found Auth-Type = TEAP
(16)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(16)     Auth-Type TEAP {
(16)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(16)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(16)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(16)         update control {
(16)           &EAP-Type := TLS
(16)         } # update control = noop
(16)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(16)       ... skipping elsif: Preceding "if" was taken
(16) eap: Expiring EAP session with state 0xb17fba92b131b7f7
(16) eap: Finished EAP session with state 0xb17fba92b131b7f7
(16) eap: Previous EAP request found for state 0xb17fba92b131b7f7, released from the list
(16) eap: Peer sent packet with method EAP TLS (13)
(16) eap: Calling submodule eap_tls to process data
(16) eap_tls: (TLS) EAP Peer says that the final record size will be 251 bytes
(16) eap_tls: (TLS) EAP Got all data (251 bytes)
(16) eap_tls: (TLS) Handshake state - before SSL initialization
(16) eap_tls: (TLS) Handshake state - Server before SSL initialization
(16) eap_tls: (TLS) Handshake state - Server before SSL initialization
(16) eap_tls: (TLS) recv TLS 1.3 Handshake, ClientHello
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read client hello
(16) eap_tls: (TLS) send TLS 1.2 Handshake, ServerHello
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write server hello
(16) eap_tls: (TLS) send TLS 1.2 Handshake, Certificate
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write certificate
(16) eap_tls: (TLS) send TLS 1.2 Handshake, ServerKeyExchange
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write key exchange
(16) eap_tls: (TLS) send TLS 1.2 Handshake, CertificateRequest
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write certificate request
(16) eap_tls: (TLS) send TLS 1.2 Handshake, ServerHelloDone
(16) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write server done
(16) eap_tls: (TLS) Server : Need to read more data: SSLv3/TLS write server done
(16) eap_tls: (TLS) In Handshake Phase
(16) eap: Sending EAP Request (code 1) ID 79 length 931
(16) eap: EAP session adding &reply:State = 0xb17fba92b030b7f7
(16)       [eap] = handled
(16)     } # Auth-Type TEAP = handled
(16) } # server inner-tunnel
(16) Virtual server sending reply
(16)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(16)   EAP-Message = 0x014f03a30dc000000d4d1603030035020000310303bdd5cd2248f1faf9ed70c1b5e3b10d1c9a4d27d2a8379ff189105355fab1c46800c030000009ff01000100001700001603030a440b000a40000a3d00068b308206873082056fa0030201020213190000002839d906f0560dcaa7000200000028300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3232313230373134303232325a170d3234313230363134303232325a306a310b3009060355040613025553310b3009060355040813024e48311430120603550407130b4c6f6e646f6e6465727279310a3008060355040a130141310a3008060355040b1301443120301e060355040313174e41432d323137312e657874727161323031322e636f6d30820222300d06092a864886f70d01010105
(16)   Message-Authenticator = 0x00000000000000000000000000000000
(16)   State = 0xb17fba92b030b7f706ab2fe838072b73
(16) eap_teap: Got tunneled Access-Challenge
(16) eap: Sending EAP Request (code 1) ID 79 length 970
(16) eap: EAP session adding &reply:State = 0x405d2b6348121c39
(16)     [eap] = handled
(16)   } # authenticate = handled
(16) Using Post-Auth-Type Challenge
(16) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(16)   Challenge { ... } # empty sub-section is ignored
(16) session-state: Saving cached attributes
(16)   Framed-MTU = 984
(16)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(16)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(16)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(16)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(16)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(16)   TLS-Session-Version = "TLS 1.2"
(16) Sent Access-Challenge Id 141 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1034
(16)   EAP-Message = 0x014f03ca370117030303bfaa281f61c0bb630aedfcdba3e0529340c8c95aa3d6f8ca121a3b9f324751673a8df3d811f255e17a03332e4fa05490a6be3e61348cb0c816c01831006010a2440c2516600c97acd7b9d3c2bfd4abcf75eab72bd1f27f29fb094a92fb87e02ec59e6468704a088255a45c2b487a9f28d8a19ca762d2845042eb5c488874a8f1aa3ab966070e1e923bc75e16b7fcb03e9d1fbd4e8af5be02806c6d4b25a407cb4a6e76d78ff7af44163ea2bc58dc83baf96fae70b5dbc553f9953d42f6fbd5f624d7cb029f804559b64a89bd7af9d4f6f94d5bc46c7ad42da8e14cdcebe286e7e4824b3ade1607f2f7390173e94bb06e6cb91a7a03f2aad1fc48ba50b496f26d3aa405d2bdc971a9602862dc91faee5b9dead895eb998f519afd093a9bb015392100eaceb2044c930e5909dc81cf519d66719039aa20af9fe19e5f6d3c7b60cd6a9380e454dac8990ad320a285b45a8d24c3e90c8e0df5079611c9d289b1c050dba2c51de0de495a971d76dfac
(16)   Message-Authenticator = 0x00000000000000000000000000000000
(16)   State = 0x405d2b6348121c39e7001e2ea9a60c4c
(16) Finished request
Waking up in 4.7 seconds.
(17) Received Access-Request Id 142 from 10.54.22.81:32769 to 10.54.27.54:1812 length 199
(17)   Message-Authenticator = 0x015017af60824ab5fefa2796d0e22eb6
(17)   User-Name = "anonymous"
(17)   State = 0x405d2b6348121c39e7001e2ea9a60c4c
(17)   NAS-IP-Address = 10.54.22.81
(17)   Called-Station-Id = "00-04-96-9b-5d-01"
(17)   NAS-Identifier = "X440G2-24t-10G4"
(17)   NAS-Port = 1005
(17)   NAS-Port-Type = Ethernet
(17)   Framed-MTU = 1300
(17)   Service-Type = Framed-User
(17)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(17)   EAP-Message = 0x024f002d3701170303002200000000000000037b254cf9117fdfbabf3d1904657ab579d028af14f3a4582e647d
(17) Restoring &session-state
(17)   &session-state:Framed-MTU = 984
(17)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(17)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(17)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(17)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(17)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(17)   &session-state:TLS-Session-Version = "TLS 1.2"
(17) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(17)   authorize {
(17)     policy filter_username {
(17)       if (&User-Name) {
(17)       if (&User-Name)  -> TRUE
(17)       if (&User-Name)  {
(17)         if (&User-Name =~ / /) {
(17)         if (&User-Name =~ / /)  -> FALSE
(17)         if (&User-Name =~ /@[^@]*@/ ) {
(17)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(17)         if (&User-Name =~ /\.\./ ) {
(17)         if (&User-Name =~ /\.\./ )  -> FALSE
(17)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(17)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(17)         if (&User-Name =~ /\.$/)  {
(17)         if (&User-Name =~ /\.$/)   -> FALSE
(17)         if (&User-Name =~ /@\./)  {
(17)         if (&User-Name =~ /@\./)   -> FALSE
(17)       } # if (&User-Name)  = notfound
(17)     } # policy filter_username = notfound
(17)     [preprocess] = ok
(17)     [chap] = noop
(17)     [mschap] = noop
(17)     [digest] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)     [suffix] = noop
(17) eap: Peer sent EAP Response (code 2) ID 79 length 45
(17) eap: No EAP Start, assuming it's an on-going EAP conversation
(17)     [eap] = updated
(17)     [files] = noop
(17)     [expiration] = noop
(17)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(17)     [pap] = noop
(17)   } # authorize = updated
(17) Found Auth-Type = eap
(17) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(17)   authenticate {
(17) eap: Expiring EAP session with state 0xb17fba92b030b7f7
(17) eap: Finished EAP session with state 0x405d2b6348121c39
(17) eap: Previous EAP request found for state 0x405d2b6348121c39, released from the list
(17) eap: Peer sent packet with method EAP TEAP (55)
(17) eap: Calling submodule eap_teap to process data
(17) eap_teap: Authenticate
(17) eap_teap: (TLS) EAP Done initial handshake
(17) eap_teap: Session established.  Proceeding to decode tunneled attributes
(17) eap_teap: Got Tunneled TEAP TLVs
(17) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x024f00060d00
(17) eap_teap: Processing received EAP Payload
(17) eap_teap: Got tunneled request
(17) eap_teap:   EAP-Message = 0x024f00060d00
(17) eap_teap: AUTHENTICATION
(17) Virtual server inner-tunnel received request
(17)   EAP-Message = 0x024f00060d00
(17)   FreeRADIUS-Proxied-To = 127.0.0.1
(17)   User-Name = "win11teap@EXTRQA2012.com"
(17)   State = 0xb17fba92b030b7f706ab2fe838072b73
(17) server inner-tunnel {
(17)   session-state: No cached attributes
(17)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(17)     authorize {
(17)       policy filter_username {
(17)         if (&User-Name) {
(17)         if (&User-Name)  -> TRUE
(17)         if (&User-Name)  {
(17)           if (&User-Name =~ / /) {
(17)           if (&User-Name =~ / /)  -> FALSE
(17)           if (&User-Name =~ /@[^@]*@/ ) {
(17)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(17)           if (&User-Name =~ /\.\./ ) {
(17)           if (&User-Name =~ /\.\./ )  -> FALSE
(17)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(17)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(17)           if (&User-Name =~ /\.$/)  {
(17)           if (&User-Name =~ /\.$/)   -> FALSE
(17)           if (&User-Name =~ /@\./)  {
(17)           if (&User-Name =~ /@\./)   -> FALSE
(17)         } # if (&User-Name)  = notfound
(17)       } # policy filter_username = notfound
(17)       [chap] = noop
(17)       [mschap] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(17) suffix: No such realm "EXTRQA2012.com"
(17)       [suffix] = noop
(17)       update control {
(17)         &Proxy-To-Realm := LOCAL
(17)       } # update control = noop
(17)       if (&outer.request:EAP-Type == TEAP) {
(17)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(17)       if (&outer.request:EAP-Type == TEAP)  {
(17)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(17)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(17)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(17)           update reply {
(17)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(17)           } # update reply = noop
(17)           update session-state {
(17)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(17)           } # update session-state = noop
(17)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(17)         ... skipping elsif: Preceding "if" was taken
(17) eap: Peer sent EAP Response (code 2) ID 79 length 6
(17) eap: No EAP Start, assuming it's an on-going EAP conversation
(17)         [eap] = updated
(17)         if (ok) {
(17)         if (ok)  -> FALSE
(17)         update config {
(17)           &Auth-Type := TEAP
(17)         } # update config = noop
(17)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(17)       [files] = noop
(17)       [expiration] = noop
(17)       [logintime] = noop
(17)       [pap] = noop
(17)     } # authorize = updated
(17)   Found Auth-Type = TEAP
(17)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(17)     Auth-Type TEAP {
(17)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(17)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(17)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(17)         update control {
(17)           &EAP-Type := TLS
(17)         } # update control = noop
(17)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(17)       ... skipping elsif: Preceding "if" was taken
(17) eap: Expiring EAP session with state 0xb17fba92b030b7f7
(17) eap: Finished EAP session with state 0xb17fba92b030b7f7
(17) eap: Previous EAP request found for state 0xb17fba92b030b7f7, released from the list
(17) eap: Peer sent packet with method EAP TLS (13)
(17) eap: Calling submodule eap_tls to process data
(17) eap_tls: (TLS) Peer ACKed our handshake fragment
(17) eap: Sending EAP Request (code 1) ID 80 length 931
(17) eap: EAP session adding &reply:State = 0xb17fba92b32fb7f7
(17)       [eap] = handled
(17)     } # Auth-Type TEAP = handled
(17) } # server inner-tunnel
(17) Virtual server sending reply
(17)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(17)   EAP-Message = 0x015003a30dc000000d4d9e172431c2e6b05d2c27c3a95a7e19301f0603551d23041830168014ebe11cec39f12f16841709ec13279a885c663a823081dd0603551d1f0481d53081d23081cfa081cca081c98681c66c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412831292c434e3d57494e3230313252322c434e3d4344502c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d455854525141323031322c44433d636f6d3f63657274696669636174655265766f636174696f6e4c6973743f626173653f6f626a656374436c6173733d63524c446973747269627574696f6e506f696e743081cc06082b060105050701010481bf3081bc3081b906082b060105050730028681ac6c6461703a2f2f2f434e3d455854525141323031322d57494e3230313252322d43412c434e3d4149412c434e3d5075626c69632532304b657925
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0xb17fba92b32fb7f706ab2fe838072b73
(17) eap_teap: Got tunneled Access-Challenge
(17) eap: Sending EAP Request (code 1) ID 80 length 970
(17) eap: EAP session adding &reply:State = 0x405d2b63490d1c39
(17)     [eap] = handled
(17)   } # authenticate = handled
(17) Using Post-Auth-Type Challenge
(17) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(17)   Challenge { ... } # empty sub-section is ignored
(17) session-state: Saving cached attributes
(17)   Framed-MTU = 984
(17)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(17)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(17)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(17)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(17)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(17)   TLS-Session-Version = "TLS 1.2"
(17) Sent Access-Challenge Id 142 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1034
(17)   EAP-Message = 0x015003ca370117030303bfaa281f61c0bb630bf525234aeb936648ee23e34aad32ceec7d65fba1ff3bb9ea89d3141e30a4cb228f1985846b0f5f95c54c5a7f6350567d00da45d40637b0491638aec3e72273933717eabf11fd59c248142347adcf083d559b9cb106d89107e0c1a4fb9afacbd4c5270996c9b2e96c214a468ea5c5bfd80c8c0522625543c207304578d2a61b09dec7482b9b8841d0d86adb4709ae1219329a54baea4a9ff301bf7eeb71e29a85341942d36e5f6c1ea849f2db3f9dbe21937646d1aea584c7f0a014ca147a34431632cffe668b14e013a3e4a68ac5a32ffe80765e84ff975440c5224be14c62580021af46793c1176aa6b3b5f9d5e18be2b4b09fd4a008d2fb605dc1940bb62a59c00675bf1b2ab36efe98dbaa958198f4751c31a005bc239568fc7f7865c97299773e5624c27d221b747a0a3325d43f1bf32f60eb652c546c90695933d03ff026247389af1a5c201408b35d74aa1c83ed59213e4fc126f98180afe4b0e5c6227be8d9fa2
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0x405d2b63490d1c39e7001e2ea9a60c4c
(17) Finished request
Waking up in 4.7 seconds.
(18) Received Access-Request Id 143 from 10.54.22.81:32769 to 10.54.27.54:1812 length 199
(18)   Message-Authenticator = 0xb272d9b23750d73b18fd7888a07abe02
(18)   User-Name = "anonymous"
(18)   State = 0x405d2b63490d1c39e7001e2ea9a60c4c
(18)   NAS-IP-Address = 10.54.22.81
(18)   Called-Station-Id = "00-04-96-9b-5d-01"
(18)   NAS-Identifier = "X440G2-24t-10G4"
(18)   NAS-Port = 1005
(18)   NAS-Port-Type = Ethernet
(18)   Framed-MTU = 1300
(18)   Service-Type = Framed-User
(18)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(18)   EAP-Message = 0x0250002d3701170303002200000000000000042665be201bb835c90bdc1fb986d9253c8ffce65cdd946d918dbc
(18) Restoring &session-state
(18)   &session-state:Framed-MTU = 984
(18)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(18)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(18)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(18)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(18)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(18)   &session-state:TLS-Session-Version = "TLS 1.2"
(18) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(18)   authorize {
(18)     policy filter_username {
(18)       if (&User-Name) {
(18)       if (&User-Name)  -> TRUE
(18)       if (&User-Name)  {
(18)         if (&User-Name =~ / /) {
(18)         if (&User-Name =~ / /)  -> FALSE
(18)         if (&User-Name =~ /@[^@]*@/ ) {
(18)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(18)         if (&User-Name =~ /\.\./ ) {
(18)         if (&User-Name =~ /\.\./ )  -> FALSE
(18)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(18)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(18)         if (&User-Name =~ /\.$/)  {
(18)         if (&User-Name =~ /\.$/)   -> FALSE
(18)         if (&User-Name =~ /@\./)  {
(18)         if (&User-Name =~ /@\./)   -> FALSE
(18)       } # if (&User-Name)  = notfound
(18)     } # policy filter_username = notfound
(18)     [preprocess] = ok
(18)     [chap] = noop
(18)     [mschap] = noop
(18)     [digest] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)     [suffix] = noop
(18) eap: Peer sent EAP Response (code 2) ID 80 length 45
(18) eap: No EAP Start, assuming it's an on-going EAP conversation
(18)     [eap] = updated
(18)     [files] = noop
(18)     [expiration] = noop
(18)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(18)     [pap] = noop
(18)   } # authorize = updated
(18) Found Auth-Type = eap
(18) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(18)   authenticate {
(18) eap: Expiring EAP session with state 0xb17fba92b32fb7f7
(18) eap: Finished EAP session with state 0x405d2b63490d1c39
(18) eap: Previous EAP request found for state 0x405d2b63490d1c39, released from the list
(18) eap: Peer sent packet with method EAP TEAP (55)
(18) eap: Calling submodule eap_teap to process data
(18) eap_teap: Authenticate
(18) eap_teap: (TLS) EAP Done initial handshake
(18) eap_teap: Session established.  Proceeding to decode tunneled attributes
(18) eap_teap: Got Tunneled TEAP TLVs
(18) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x025000060d00
(18) eap_teap: Processing received EAP Payload
(18) eap_teap: Got tunneled request
(18) eap_teap:   EAP-Message = 0x025000060d00
(18) eap_teap: AUTHENTICATION
(18) Virtual server inner-tunnel received request
(18)   EAP-Message = 0x025000060d00
(18)   FreeRADIUS-Proxied-To = 127.0.0.1
(18)   User-Name = "win11teap@EXTRQA2012.com"
(18)   State = 0xb17fba92b32fb7f706ab2fe838072b73
(18) server inner-tunnel {
(18)   session-state: No cached attributes
(18)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(18)     authorize {
(18)       policy filter_username {
(18)         if (&User-Name) {
(18)         if (&User-Name)  -> TRUE
(18)         if (&User-Name)  {
(18)           if (&User-Name =~ / /) {
(18)           if (&User-Name =~ / /)  -> FALSE
(18)           if (&User-Name =~ /@[^@]*@/ ) {
(18)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(18)           if (&User-Name =~ /\.\./ ) {
(18)           if (&User-Name =~ /\.\./ )  -> FALSE
(18)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(18)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(18)           if (&User-Name =~ /\.$/)  {
(18)           if (&User-Name =~ /\.$/)   -> FALSE
(18)           if (&User-Name =~ /@\./)  {
(18)           if (&User-Name =~ /@\./)   -> FALSE
(18)         } # if (&User-Name)  = notfound
(18)       } # policy filter_username = notfound
(18)       [chap] = noop
(18)       [mschap] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(18) suffix: No such realm "EXTRQA2012.com"
(18)       [suffix] = noop
(18)       update control {
(18)         &Proxy-To-Realm := LOCAL
(18)       } # update control = noop
(18)       if (&outer.request:EAP-Type == TEAP) {
(18)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(18)       if (&outer.request:EAP-Type == TEAP)  {
(18)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(18)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(18)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(18)           update reply {
(18)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(18)           } # update reply = noop
(18)           update session-state {
(18)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(18)           } # update session-state = noop
(18)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(18)         ... skipping elsif: Preceding "if" was taken
(18) eap: Peer sent EAP Response (code 2) ID 80 length 6
(18) eap: No EAP Start, assuming it's an on-going EAP conversation
(18)         [eap] = updated
(18)         if (ok) {
(18)         if (ok)  -> FALSE
(18)         update config {
(18)           &Auth-Type := TEAP
(18)         } # update config = noop
(18)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(18)       [files] = noop
(18)       [expiration] = noop
(18)       [logintime] = noop
(18)       [pap] = noop
(18)     } # authorize = updated
(18)   Found Auth-Type = TEAP
(18)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(18)     Auth-Type TEAP {
(18)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(18)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(18)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(18)         update control {
(18)           &EAP-Type := TLS
(18)         } # update control = noop
(18)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(18)       ... skipping elsif: Preceding "if" was taken
(18) eap: Expiring EAP session with state 0xb17fba92b32fb7f7
(18) eap: Finished EAP session with state 0xb17fba92b32fb7f7
(18) eap: Previous EAP request found for state 0xb17fba92b32fb7f7, released from the list
(18) eap: Peer sent packet with method EAP TLS (13)
(18) eap: Calling submodule eap_tls to process data
(18) eap_tls: (TLS) Peer ACKed our handshake fragment
(18) eap: Sending EAP Request (code 1) ID 81 length 931
(18) eap: EAP session adding &reply:State = 0xb17fba92b22eb7f7
(18)       [eap] = handled
(18)     } # Auth-Type TEAP = handled
(18) } # server inner-tunnel
(18) Virtual server sending reply
(18)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(18)   EAP-Message = 0x015103a30dc000000d4d5141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3232303630323138353230375a170d3237303732323134333033325a305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d434130820122300d06092a864886f70d01010105000382010f003082010a0282010100c5df228307acbda10e7e7882c15e8a14c74a3e7cf71f3a17562359b95b367af7d7b94dd2f8f9b34a252105f55b39a8882a46ba6b8cfa91a89cea9fcdc949bff239927510d1e18b48bed184412961076e535744fed109eaf694efbc4c5c56baff4c1a849dc4757341c1bf15f0c021488ea1a8b67f07e2d1670325a40e432f22e3dabb2069247eef899ca879a2273a918f5028cf016673ea2b970735b5b585d92b6a80526fec3cea7f6465e42e400a02
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0xb17fba92b22eb7f706ab2fe838072b73
(18) eap_teap: Got tunneled Access-Challenge
(18) eap: Sending EAP Request (code 1) ID 81 length 970
(18) eap: EAP session adding &reply:State = 0x405d2b634a0c1c39
(18)     [eap] = handled
(18)   } # authenticate = handled
(18) Using Post-Auth-Type Challenge
(18) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(18)   Challenge { ... } # empty sub-section is ignored
(18) session-state: Saving cached attributes
(18)   Framed-MTU = 984
(18)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(18)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(18)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(18)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(18)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(18)   TLS-Session-Version = "TLS 1.2"
(18) Sent Access-Challenge Id 143 from 10.54.27.54:1812 to 10.54.22.81:32769 length 1034
(18)   EAP-Message = 0x015103ca370117030303bfaa281f61c0bb630ca38007a8aebc5c4b609a772b89d27c3aeaa030cc375d914a037397f6ec14ce929aeb54f3e046950528641f7bd1c7b6c2c2390c9da835f1e360b3a98500979a71346dee9e14b7003f6edc94fd0f69de41f2f6876090af06360c3a32fef9a190b28864411da9501350437ce2fd2b12f32c936a914a927b5e43e46a045938c75acb6f30f96f1167c7bd666f7d2cb829244e57d4364b365ecdf3914fc5c28e458ab3370755d99a97980f7e22df373352083b996fa5ef1c100a008123bb7af0892c72eb23a0d842cd95870169e58ff0e656f5a2a5105648051f56188ff8035ead18a1d66de54ee7180c72fc8172ab1f835b8c9dea4d52343cea55fa797fdd4782761c1eeb179ce71d2c88cdb49d62c29e240005e903494c41623b63667981b21d461f20fb409b4d49ce3974c7bd061148a641c25cca072c58af1de1c1c24e34fa84b9e3445be19b73a401edc93d083ee1a5ed90a97165f33b62cc75097e5d25c66bbe99854ddf
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0x405d2b634a0c1c39e7001e2ea9a60c4c
(18) Finished request
Waking up in 4.7 seconds.
(19) Received Access-Request Id 144 from 10.54.22.81:32769 to 10.54.27.54:1812 length 199
(19)   Message-Authenticator = 0x017cf8394cc09a2b7e99cb87cb65db43
(19)   User-Name = "anonymous"
(19)   State = 0x405d2b634a0c1c39e7001e2ea9a60c4c
(19)   NAS-IP-Address = 10.54.22.81
(19)   Called-Station-Id = "00-04-96-9b-5d-01"
(19)   NAS-Identifier = "X440G2-24t-10G4"
(19)   NAS-Port = 1005
(19)   NAS-Port-Type = Ethernet
(19)   Framed-MTU = 1300
(19)   Service-Type = Framed-User
(19)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(19)   EAP-Message = 0x0251002d37011703030022000000000000000538cda9642b9fc973db4b1d0326772cb4bd050275b3db194ed64d
(19) Restoring &session-state
(19)   &session-state:Framed-MTU = 984
(19)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(19)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(19)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(19)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(19)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(19)   &session-state:TLS-Session-Version = "TLS 1.2"
(19) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(19)   authorize {
(19)     policy filter_username {
(19)       if (&User-Name) {
(19)       if (&User-Name)  -> TRUE
(19)       if (&User-Name)  {
(19)         if (&User-Name =~ / /) {
(19)         if (&User-Name =~ / /)  -> FALSE
(19)         if (&User-Name =~ /@[^@]*@/ ) {
(19)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(19)         if (&User-Name =~ /\.\./ ) {
(19)         if (&User-Name =~ /\.\./ )  -> FALSE
(19)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(19)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(19)         if (&User-Name =~ /\.$/)  {
(19)         if (&User-Name =~ /\.$/)   -> FALSE
(19)         if (&User-Name =~ /@\./)  {
(19)         if (&User-Name =~ /@\./)   -> FALSE
(19)       } # if (&User-Name)  = notfound
(19)     } # policy filter_username = notfound
(19)     [preprocess] = ok
(19)     [chap] = noop
(19)     [mschap] = noop
(19)     [digest] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(19) suffix: No such realm "NULL"
(19)     [suffix] = noop
(19) eap: Peer sent EAP Response (code 2) ID 81 length 45
(19) eap: No EAP Start, assuming it's an on-going EAP conversation
(19)     [eap] = updated
(19)     [files] = noop
(19)     [expiration] = noop
(19)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(19)     [pap] = noop
(19)   } # authorize = updated
(19) Found Auth-Type = eap
(19) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(19)   authenticate {
(19) eap: Expiring EAP session with state 0xb17fba92b22eb7f7
(19) eap: Finished EAP session with state 0x405d2b634a0c1c39
(19) eap: Previous EAP request found for state 0x405d2b634a0c1c39, released from the list
(19) eap: Peer sent packet with method EAP TEAP (55)
(19) eap: Calling submodule eap_teap to process data
(19) eap_teap: Authenticate
(19) eap_teap: (TLS) EAP Done initial handshake
(19) eap_teap: Session established.  Proceeding to decode tunneled attributes
(19) eap_teap: Got Tunneled TEAP TLVs
(19) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x025100060d00
(19) eap_teap: Processing received EAP Payload
(19) eap_teap: Got tunneled request
(19) eap_teap:   EAP-Message = 0x025100060d00
(19) eap_teap: AUTHENTICATION
(19) Virtual server inner-tunnel received request
(19)   EAP-Message = 0x025100060d00
(19)   FreeRADIUS-Proxied-To = 127.0.0.1
(19)   User-Name = "win11teap@EXTRQA2012.com"
(19)   State = 0xb17fba92b22eb7f706ab2fe838072b73
(19) server inner-tunnel {
(19)   session-state: No cached attributes
(19)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(19)     authorize {
(19)       policy filter_username {
(19)         if (&User-Name) {
(19)         if (&User-Name)  -> TRUE
(19)         if (&User-Name)  {
(19)           if (&User-Name =~ / /) {
(19)           if (&User-Name =~ / /)  -> FALSE
(19)           if (&User-Name =~ /@[^@]*@/ ) {
(19)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(19)           if (&User-Name =~ /\.\./ ) {
(19)           if (&User-Name =~ /\.\./ )  -> FALSE
(19)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(19)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(19)           if (&User-Name =~ /\.$/)  {
(19)           if (&User-Name =~ /\.$/)   -> FALSE
(19)           if (&User-Name =~ /@\./)  {
(19)           if (&User-Name =~ /@\./)   -> FALSE
(19)         } # if (&User-Name)  = notfound
(19)       } # policy filter_username = notfound
(19)       [chap] = noop
(19)       [mschap] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(19) suffix: No such realm "EXTRQA2012.com"
(19)       [suffix] = noop
(19)       update control {
(19)         &Proxy-To-Realm := LOCAL
(19)       } # update control = noop
(19)       if (&outer.request:EAP-Type == TEAP) {
(19)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(19)       if (&outer.request:EAP-Type == TEAP)  {
(19)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(19)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(19)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(19)           update reply {
(19)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(19)           } # update reply = noop
(19)           update session-state {
(19)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(19)           } # update session-state = noop
(19)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(19)         ... skipping elsif: Preceding "if" was taken
(19) eap: Peer sent EAP Response (code 2) ID 81 length 6
(19) eap: No EAP Start, assuming it's an on-going EAP conversation
(19)         [eap] = updated
(19)         if (ok) {
(19)         if (ok)  -> FALSE
(19)         update config {
(19)           &Auth-Type := TEAP
(19)         } # update config = noop
(19)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(19)       [files] = noop
(19)       [expiration] = noop
(19)       [logintime] = noop
(19)       [pap] = noop
(19)     } # authorize = updated
(19)   Found Auth-Type = TEAP
(19)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(19)     Auth-Type TEAP {
(19)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(19)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(19)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(19)         update control {
(19)           &EAP-Type := TLS
(19)         } # update control = noop
(19)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(19)       ... skipping elsif: Preceding "if" was taken
(19) eap: Expiring EAP session with state 0xb17fba92b22eb7f7
(19) eap: Finished EAP session with state 0xb17fba92b22eb7f7
(19) eap: Previous EAP request found for state 0xb17fba92b22eb7f7, released from the list
(19) eap: Peer sent packet with method EAP TLS (13)
(19) eap: Calling submodule eap_tls to process data
(19) eap_tls: (TLS) Peer ACKed our handshake fragment
(19) eap: Sending EAP Request (code 1) ID 82 length 652
(19) eap: EAP session adding &reply:State = 0xb17fba92b52db7f7
(19)       [eap] = handled
(19)     } # Auth-Type TEAP = handled
(19) } # server inner-tunnel
(19) Virtual server sending reply
(19)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(19)   EAP-Message = 0x0152028c0d8000000d4d6840c4c4dea23f072cc4bc190136f018ed1340e03e037826cea2389baa8308f1eb3eb9e9a2631b53b230ab8293a7aef505a1e7df611003bda07f1653c3f988c19415e83fdea71342e379b4a8fcdb662b90655846117a92c6c702d343db7ede1dd9e5173ab3c5a303ea5aff1627c69c14d35b02eb49f45604595939a5f3ec241932d4e9a4e3ab6062223ae9db11df60932b3e410062dc81f18aacf2dfebb59fb3de235ff56413f0a076aa04275354644d89eb8875120b3f7fb1c186f4d5a77a9b2a72793d21deb6cbde4a73956ba7ccc473e509d298a5055972aa0f40511763c4c68fbd798c033469cdf47b57008c9de4c965d24e67d3076a09aea150ca0c8d6e9b11ec1e718ec03cfc0f196f6f2c8de30e4c808d7928f17200d07c298ce2025a6ca245e1a847997dd5100ae0bc0fd587b10818a7496a4050c920097a323304bb9728d67be0da1d4bb2b011f7020e23a0da75c7a365ab9791f1a465628b499591d92447bb85e70683656058b49b
(19)   Message-Authenticator = 0x00000000000000000000000000000000
(19)   State = 0xb17fba92b52db7f706ab2fe838072b73
(19) eap_teap: Got tunneled Access-Challenge
(19) eap: Sending EAP Request (code 1) ID 82 length 691
(19) eap: EAP session adding &reply:State = 0x405d2b634b0f1c39
(19)     [eap] = handled
(19)   } # authenticate = handled
(19) Using Post-Auth-Type Challenge
(19) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(19)   Challenge { ... } # empty sub-section is ignored
(19) session-state: Saving cached attributes
(19)   Framed-MTU = 984
(19)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(19)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(19)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(19)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(19)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(19)   TLS-Session-Version = "TLS 1.2"
(19) Sent Access-Challenge Id 144 from 10.54.27.54:1812 to 10.54.22.81:32769 length 753
(19)   EAP-Message = 0x015202b3370117030302a8aa281f61c0bb630dbd0e29bcbeb21522a5381d3035cd0ebe757f29a4e8fbabeaf104b69826b6728790118ae7a7eb4b52b24c356a399952903a6a832215b40634a1ee850ce1511bce416c6f4239848db3a379a0b86164cb6df04defa833b3ed364e032bf926dc90810faee20cf3446fa7bc0ac1dcf2a26e688dc185301f73ed099ec8c86a6fd5212decf76e844867919a4da64ebf3eb2541bd6e7a69232eeac86e5d981192e818e9fdcd216fffe6a0db9b0311325612bde7e41f421e4d000eb4585f655bd0ab6aaf034c4d6fec444aabb2cf3c15d85872c970497cf6031c283b130590a9415b2fdeb23585cba1c1c13448014ddfe9cd74a5c35f0d62b6885260ab57e3ca85e496870f403e499bec863e1e3b4551f63afd1d0d1ba641429c8378ccd434330a6c92aa6de43f4237411e411a3be69732e2efb87ad921d40374d990a974a4b0d04c257543559f340cffe25ce5634d09dfd24bd631f3fd2dc1ad86716e8e5be3e90aa307bffc7990d
(19)   Message-Authenticator = 0x00000000000000000000000000000000
(19)   State = 0x405d2b634b0f1c39e7001e2ea9a60c4c
(19) Finished request
Waking up in 4.7 seconds.
(20) Received Access-Request Id 145 from 10.54.22.81:32769 to 10.54.27.54:1812 length 1656
(20)   Message-Authenticator = 0x290bb34aa5d476e530c19abead284c2e
(20)   User-Name = "anonymous"
(20)   State = 0x405d2b634b0f1c39e7001e2ea9a60c4c
(20)   NAS-IP-Address = 10.54.22.81
(20)   Called-Station-Id = "00-04-96-9b-5d-01"
(20)   NAS-Identifier = "X440G2-24t-10G4"
(20)   NAS-Port = 1005
(20)   NAS-Port-Type = Ethernet
(20)   Framed-MTU = 1300
(20)   Service-Type = Framed-User
(20)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(20)   EAP-Message = 0x025205d437c10000079717030307920000000000000006f158b7169998cc748e363b73493d6493f2baf75a0bc90cf7b5a3d2784f3f4fdf8551821baf66c0c1ad70fac18783fa6475e8f08979d068bdbc3e49cc5777ea6284a47fc885bdf1d07628ce0350e0ca49186420fc43b6b7e50c56313bdf3fb3fe7aa02c3d878ec872e4b05e9526c2b1dea40ae3195fc2d07c519b01302a167c663735f67bc0dc263065438964d310cac2e0f6c8184db6775a6ca4c1f9e9e8fd9470bdc47c5f76cd351573277428f4594589aa3f91ebe1ee4dbc01c96b3c81624126cd219d3af1ee0960d9d1cc09a507fd1934953cdbd022a01cace79888da15e744b5c65dc4818735692ea98c4c8ae454a0a8de3866556e9b575182a3be2d6a7f3cef17fe330ed73919b45dfc9b4cb88f2322472f45a84a80d040d172e7c98569000e35c2c627b74bbb6ace61d6e8f2069db120edf00e7d025c315053597e6f25d61ac13f0a0c0917b32f3d8ce404806d4decc90677a13d2aaff544fb082aab13
(20) Restoring &session-state
(20)   &session-state:Framed-MTU = 984
(20)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(20)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(20)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(20)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(20)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(20)   &session-state:TLS-Session-Version = "TLS 1.2"
(20) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(20)   authorize {
(20)     policy filter_username {
(20)       if (&User-Name) {
(20)       if (&User-Name)  -> TRUE
(20)       if (&User-Name)  {
(20)         if (&User-Name =~ / /) {
(20)         if (&User-Name =~ / /)  -> FALSE
(20)         if (&User-Name =~ /@[^@]*@/ ) {
(20)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(20)         if (&User-Name =~ /\.\./ ) {
(20)         if (&User-Name =~ /\.\./ )  -> FALSE
(20)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(20)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(20)         if (&User-Name =~ /\.$/)  {
(20)         if (&User-Name =~ /\.$/)   -> FALSE
(20)         if (&User-Name =~ /@\./)  {
(20)         if (&User-Name =~ /@\./)   -> FALSE
(20)       } # if (&User-Name)  = notfound
(20)     } # policy filter_username = notfound
(20)     [preprocess] = ok
(20)     [chap] = noop
(20)     [mschap] = noop
(20)     [digest] = noop
(20) suffix: Checking for suffix after "@"
(20) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(20) suffix: No such realm "NULL"
(20)     [suffix] = noop
(20) eap: Peer sent EAP Response (code 2) ID 82 length 1492
(20) eap: No EAP Start, assuming it's an on-going EAP conversation
(20)     [eap] = updated
(20)     [files] = noop
(20)     [expiration] = noop
(20)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(20)     [pap] = noop
(20)   } # authorize = updated
(20) Found Auth-Type = eap
(20) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(20)   authenticate {
(20) eap: Expiring EAP session with state 0xb17fba92b52db7f7
(20) eap: Finished EAP session with state 0x405d2b634b0f1c39
(20) eap: Previous EAP request found for state 0x405d2b634b0f1c39, released from the list
(20) eap: Peer sent packet with method EAP TEAP (55)
(20) eap: Calling submodule eap_teap to process data
(20) eap_teap: Authenticate
(20) eap_teap: (TLS) EAP Peer says that the final record size will be 1943 bytes
(20) eap_teap: (TLS) EAP Expecting 2 fragments
(20) eap_teap: (TLS) EAP Got first TLS fragment (1482 bytes).  Peer says more fragments will follow
(20) eap_teap: (TLS) EAP ACKing fragment, the peer should send more data.
(20) eap_teap: (TLS) EAP Init is done, but tunneled data is fragmented
(20) eap: Sending EAP Request (code 1) ID 83 length 6
(20) eap: EAP session adding &reply:State = 0x405d2b634c0e1c39
(20)     [eap] = handled
(20)   } # authenticate = handled
(20) Using Post-Auth-Type Challenge
(20) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(20)   Challenge { ... } # empty sub-section is ignored
(20) session-state: Saving cached attributes
(20)   Framed-MTU = 984
(20)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(20)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(20)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(20)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(20)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(20)   TLS-Session-Version = "TLS 1.2"
(20) Sent Access-Challenge Id 145 from 10.54.27.54:1812 to 10.54.22.81:32769 length 64
(20)   EAP-Message = 0x015300063701
(20)   Message-Authenticator = 0x00000000000000000000000000000000
(20)   State = 0x405d2b634c0e1c39e7001e2ea9a60c4c
(20) Finished request
Waking up in 4.7 seconds.
(21) Received Access-Request Id 146 from 10.54.22.81:32769 to 10.54.27.54:1812 length 623
(21)   Message-Authenticator = 0x194675720bd87f8013e176c34315417f
(21)   User-Name = "anonymous"
(21)   State = 0x405d2b634c0e1c39e7001e2ea9a60c4c
(21)   NAS-IP-Address = 10.54.22.81
(21)   Called-Station-Id = "00-04-96-9b-5d-01"
(21)   NAS-Identifier = "X440G2-24t-10G4"
(21)   NAS-Port = 1005
(21)   NAS-Port-Type = Ethernet
(21)   Framed-MTU = 1300
(21)   Service-Type = Framed-User
(21)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(21)   EAP-Message = 0x025301d33701947b4a4ec4a58c13e4cf71f4e1370da92636ae3aec1f15bb521693fdf554ec02c6ff662e87a872a5d2bfa9ac43cceac4cfc7fba49df15f05410217ebe76c4947f01f84bb737a5474f12c087480093b75403e721562a7520377ad5229bc4a443e064db698441b6af9674e7a9727710580b01e86b14aeddc51d3a31ee196921fe76d73b7b0817906261aad30df0c4f8fed34d37955219ab0fb19748e067d45833f197ec891ce36630dd91ede3f6cce523461afa5e9ba7f5050feb018d86226adad892b9a597f26f62b202ce572bf25da54cff73865086947d77dfb6faa705309d52127de843f0567ee61359bfb8249f73b749a4b8e6580e119d68a61678126ce9fc206966c295b38fb2facb534ba05470b3a72ca22f9d9b0318bac2a04a6d6ef86d9978f129d867685d9a13ee7cf6f556caa5318add15c3aa347a7f26b41973ce7062ee3d3f264ceeb124ba3d844779b2ba63df136dd40bc89d59b097a53cd065072de75aef3c02afc0ed6ae2363f1063ece
(21) Restoring &session-state
(21)   &session-state:Framed-MTU = 984
(21)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(21)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(21)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(21)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(21)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(21)   &session-state:TLS-Session-Version = "TLS 1.2"
(21) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(21)   authorize {
(21)     policy filter_username {
(21)       if (&User-Name) {
(21)       if (&User-Name)  -> TRUE
(21)       if (&User-Name)  {
(21)         if (&User-Name =~ / /) {
(21)         if (&User-Name =~ / /)  -> FALSE
(21)         if (&User-Name =~ /@[^@]*@/ ) {
(21)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(21)         if (&User-Name =~ /\.\./ ) {
(21)         if (&User-Name =~ /\.\./ )  -> FALSE
(21)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(21)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(21)         if (&User-Name =~ /\.$/)  {
(21)         if (&User-Name =~ /\.$/)   -> FALSE
(21)         if (&User-Name =~ /@\./)  {
(21)         if (&User-Name =~ /@\./)   -> FALSE
(21)       } # if (&User-Name)  = notfound
(21)     } # policy filter_username = notfound
(21)     [preprocess] = ok
(21)     [chap] = noop
(21)     [mschap] = noop
(21)     [digest] = noop
(21) suffix: Checking for suffix after "@"
(21) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(21) suffix: No such realm "NULL"
(21)     [suffix] = noop
(21) eap: Peer sent EAP Response (code 2) ID 83 length 467
(21) eap: No EAP Start, assuming it's an on-going EAP conversation
(21)     [eap] = updated
(21)     [files] = noop
(21)     [expiration] = noop
(21)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(21)     [pap] = noop
(21)   } # authorize = updated
(21) Found Auth-Type = eap
(21) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(21)   authenticate {
(21) eap: Expiring EAP session with state 0xb17fba92b52db7f7
(21) eap: Finished EAP session with state 0x405d2b634c0e1c39
(21) eap: Previous EAP request found for state 0x405d2b634c0e1c39, released from the list
(21) eap: Peer sent packet with method EAP TEAP (55)
(21) eap: Calling submodule eap_teap to process data
(21) eap_teap: Authenticate
(21) eap_teap: (TLS) EAP Done initial handshake
(21) eap_teap: Session established.  Proceeding to decode tunneled attributes
(21) eap_teap: Got Tunneled TEAP TLVs
(21) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x025207760d800000076c16030307340b0006030006000005fd308205f9308204e1a003020102021319000000290714d9de227d719b000200000029300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3233303231353136333331365a170d3234303231353136333331365a305531133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a45585452514132303132310e300c060355040313055573657273311230100603550403130977696e31317465617030820122300d06092a864886f70d01010105000382010f003082010a0282010100c7d3b9e8a056828138494894ec36e252e05620669da7b3a832e19e8afcf8c30fb40fd6bc77f8836a88641dc5dc1b489228db655585fd
(21) eap_teap: Processing received EAP Payload
(21) eap_teap: Got tunneled request
(21) eap_teap:   EAP-Message = 0x025207760d800000076c16030307340b0006030006000005fd308205f9308204e1a003020102021319000000290714d9de227d719b000200000029300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3233303231353136333331365a170d3234303231353136333331365a305531133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a45585452514132303132310e300c060355040313055573657273311230100603550403130977696e31317465617030820122300d06092a864886f70d01010105000382010f003082010a0282010100c7d3b9e8a056828138494894ec36e252e05620669da7b3a832e19e8afcf8c30fb40fd6bc77f8836a88641dc5dc1b489228db655585fdfd10c038774839651330
(21) eap_teap: AUTHENTICATION
(21) Virtual server inner-tunnel received request
(21)   EAP-Message = 0x025207760d800000076c16030307340b0006030006000005fd308205f9308204e1a003020102021319000000290714d9de227d719b000200000029300d06092a864886f70d01010b0500305331133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a455854525141323031323120301e06035504031317455854525141323031322d57494e3230313252322d4341301e170d3233303231353136333331365a170d3234303231353136333331365a305531133011060a0992268993f22c6401191603636f6d311a3018060a0992268993f22c640119160a45585452514132303132310e300c060355040313055573657273311230100603550403130977696e31317465617030820122300d06092a864886f70d01010105000382010f003082010a0282010100c7d3b9e8a056828138494894ec36e252e05620669da7b3a832e19e8afcf8c30fb40fd6bc77f8836a88641dc5dc1b489228db655585fdfd10c038774839651330
(21)   FreeRADIUS-Proxied-To = 127.0.0.1
(21)   User-Name = "win11teap@EXTRQA2012.com"
(21)   State = 0xb17fba92b52db7f706ab2fe838072b73
(21) server inner-tunnel {
(21)   session-state: No cached attributes
(21)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(21)     authorize {
(21)       policy filter_username {
(21)         if (&User-Name) {
(21)         if (&User-Name)  -> TRUE
(21)         if (&User-Name)  {
(21)           if (&User-Name =~ / /) {
(21)           if (&User-Name =~ / /)  -> FALSE
(21)           if (&User-Name =~ /@[^@]*@/ ) {
(21)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(21)           if (&User-Name =~ /\.\./ ) {
(21)           if (&User-Name =~ /\.\./ )  -> FALSE
(21)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(21)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(21)           if (&User-Name =~ /\.$/)  {
(21)           if (&User-Name =~ /\.$/)   -> FALSE
(21)           if (&User-Name =~ /@\./)  {
(21)           if (&User-Name =~ /@\./)   -> FALSE
(21)         } # if (&User-Name)  = notfound
(21)       } # policy filter_username = notfound
(21)       [chap] = noop
(21)       [mschap] = noop
(21) suffix: Checking for suffix after "@"
(21) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(21) suffix: No such realm "EXTRQA2012.com"
(21)       [suffix] = noop
(21)       update control {
(21)         &Proxy-To-Realm := LOCAL
(21)       } # update control = noop
(21)       if (&outer.request:EAP-Type == TEAP) {
(21)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(21)       if (&outer.request:EAP-Type == TEAP)  {
(21)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(21)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(21)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(21)           update reply {
(21)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(21)           } # update reply = noop
(21)           update session-state {
(21)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(21)           } # update session-state = noop
(21)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(21)         ... skipping elsif: Preceding "if" was taken
(21) eap: Peer sent EAP Response (code 2) ID 82 length 1910
(21) eap: No EAP Start, assuming it's an on-going EAP conversation
(21)         [eap] = updated
(21)         if (ok) {
(21)         if (ok)  -> FALSE
(21)         update config {
(21)           &Auth-Type := TEAP
(21)         } # update config = noop
(21)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(21)       [files] = noop
(21)       [expiration] = noop
(21)       [logintime] = noop
(21)       [pap] = noop
(21)     } # authorize = updated
(21)   Found Auth-Type = TEAP
(21)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(21)     Auth-Type TEAP {
(21)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(21)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(21)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(21)         update control {
(21)           &EAP-Type := TLS
(21)         } # update control = noop
(21)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(21)       ... skipping elsif: Preceding "if" was taken
(21) eap: Expiring EAP session with state 0xb17fba92b52db7f7
(21) eap: Finished EAP session with state 0xb17fba92b52db7f7
(21) eap: Previous EAP request found for state 0xb17fba92b52db7f7, released from the list
(21) eap: Peer sent packet with method EAP TLS (13)
(21) eap: Calling submodule eap_tls to process data
(21) eap_tls: (TLS) EAP Peer says that the final record size will be 1900 bytes
(21) eap_tls: (TLS) EAP Got all data (1900 bytes)
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write server done
(21) eap_tls: (TLS) recv TLS 1.2 Handshake, Certificate
(21) eap_tls: (TLS) Creating attributes from server certificate
(21) eap_tls:   TLS-Cert-Serial := "11ea5e6eb56344bc406f02e09f880bcb"
(21) eap_tls:   TLS-Cert-Expiration := "270722143032Z"
(21) eap_tls:   TLS-Cert-Valid-Since := "220602185207Z"
(21) eap_tls:   TLS-Cert-Subject := "/DC=com/DC=EXTRQA2012/CN=EXTRQA2012-WIN2012R2-CA"
(21) eap_tls:   TLS-Cert-Issuer := "/DC=com/DC=EXTRQA2012/CN=EXTRQA2012-WIN2012R2-CA"
(21) eap_tls:   TLS-Cert-Common-Name := "EXTRQA2012-WIN2012R2-CA"
(21) eap_tls: (TLS) Creating attributes from client certificate
(21) eap_tls:   TLS-Client-Cert-Serial := "19000000290714d9de227d719b000200000029"
(21) eap_tls:   TLS-Client-Cert-Expiration := "240215163316Z"
(21) eap_tls:   TLS-Client-Cert-Valid-Since := "230215163316Z"
(21) eap_tls:   TLS-Client-Cert-Subject := "/DC=com/DC=EXTRQA2012/CN=Users/CN=win11teap"
(21) eap_tls:   TLS-Client-Cert-Issuer := "/DC=com/DC=EXTRQA2012/CN=EXTRQA2012-WIN2012R2-CA"
(21) eap_tls:   TLS-Client-Cert-Common-Name := "Users"
(21) eap_tls:   TLS-Client-Cert-Subject-Alt-Name-Upn := "win11teap@EXTRQA2012.com"
(21) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage += "Microsoft Encrypted File System, E-mail Protection, TLS Web Client Authentication"
(21) eap_tls:   TLS-Client-Cert-X509v3-Subject-Key-Identifier += "C1:58:9C:52:93:96:B3:7B:DC:3A:1A:04:B9:3F:17:72:CD:61:64:AD"
(21) eap_tls:   TLS-Client-Cert-X509v3-Authority-Key-Identifier += "keyid:EB:E1:1C:EC:39:F1:2F:16:84:17:09:EC:13:27:9A:88:5C:66:3A:82\n"
(21) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage-OID += "1.3.6.1.4.1.311.10.3.4"
(21) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage-OID += "1.3.6.1.5.5.7.3.4"
(21) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage-OID += "1.3.6.1.5.5.7.3.2"
Certificate chain - 1 cert(s) untrusted
(TLS) untrusted certificate with depth [0] subject name /DC=com/DC=EXTRQA2012/CN=Users/CN=win11teap
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read client certificate
(21) eap_tls: (TLS) recv TLS 1.2 Handshake, ClientKeyExchange
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read client key exchange
(21) eap_tls: (TLS) recv TLS 1.2 Handshake, CertificateVerify
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read certificate verify
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read change cipher spec
(21) eap_tls: (TLS) recv TLS 1.2 Handshake, Finished
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read finished
(21) eap_tls: (TLS) send TLS 1.2 ChangeCipherSpec
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write change cipher spec
(21) eap_tls: (TLS) send TLS 1.2 Handshake, Finished
(21) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write finished
(21) eap_tls: (TLS) Handshake state - SSL negotiation finished successfully
(21) eap_tls: (TLS) Connection Established
(21) eap_tls:   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(21) eap_tls:   TLS-Session-Version = "TLS 1.2"
(21) eap: Sending EAP Request (code 1) ID 83 length 61
(21) eap: EAP session adding &reply:State = 0xb17fba92b42cb7f7
(21)       [eap] = handled
(21)     } # Auth-Type TEAP = handled
(21) } # server inner-tunnel
(21) Virtual server sending reply
(21)   FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(21)   EAP-Message = 0x0153003d0d8000000033140303000101160303002849152e221cc360705fd1f1737f239b4f69f80906f4dfb0a7165fd66b6f69888e17ea24e241f87a3a
(21)   Message-Authenticator = 0x00000000000000000000000000000000
(21)   State = 0xb17fba92b42cb7f706ab2fe838072b73
(21) eap_teap: Got tunneled Access-Challenge
(21) eap: Sending EAP Request (code 1) ID 84 length 100
(21) eap: EAP session adding &reply:State = 0x405d2b634d091c39
(21)     [eap] = handled
(21)   } # authenticate = handled
(21) Using Post-Auth-Type Challenge
(21) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(21)   Challenge { ... } # empty sub-section is ignored
(21) session-state: Saving cached attributes
(21)   Framed-MTU = 984
(21)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(21)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(21)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(21)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(21)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(21)   TLS-Session-Version = "TLS 1.2"
(21) Sent Access-Challenge Id 146 from 10.54.27.54:1812 to 10.54.22.81:32769 length 158
(21)   EAP-Message = 0x0154006437011703030059aa281f61c0bb630e57e751eb3b4116a53ec42c3e9e1b4da48e7b6351a685422db16f7125bf45c88a905d8204fbde8c2bf8f5fa50a11b954caec325402841ec7ddbdfe2cbbeb925e903b99f19fb6b8241684bc9a16a7a5df47f
(21)   Message-Authenticator = 0x00000000000000000000000000000000
(21)   State = 0x405d2b634d091c39e7001e2ea9a60c4c
(21) Finished request
Waking up in 4.6 seconds.
(22) Received Access-Request Id 147 from 10.54.22.81:32769 to 10.54.27.54:1812 length 199
(22)   Message-Authenticator = 0x793a8e1c30b890a19f801768fc8049a4
(22)   User-Name = "anonymous"
(22)   State = 0x405d2b634d091c39e7001e2ea9a60c4c
(22)   NAS-IP-Address = 10.54.22.81
(22)   Called-Station-Id = "00-04-96-9b-5d-01"
(22)   NAS-Identifier = "X440G2-24t-10G4"
(22)   NAS-Port = 1005
(22)   NAS-Port-Type = Ethernet
(22)   Framed-MTU = 1300
(22)   Service-Type = Framed-User
(22)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(22)   EAP-Message = 0x0254002d370117030300220000000000000007104800a2cece4dedec89ae833932519d5a9be7ec3f622d189707
(22) Restoring &session-state
(22)   &session-state:Framed-MTU = 984
(22)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(22)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(22)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(22)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(22)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(22)   &session-state:TLS-Session-Version = "TLS 1.2"
(22) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(22)   authorize {
(22)     policy filter_username {
(22)       if (&User-Name) {
(22)       if (&User-Name)  -> TRUE
(22)       if (&User-Name)  {
(22)         if (&User-Name =~ / /) {
(22)         if (&User-Name =~ / /)  -> FALSE
(22)         if (&User-Name =~ /@[^@]*@/ ) {
(22)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(22)         if (&User-Name =~ /\.\./ ) {
(22)         if (&User-Name =~ /\.\./ )  -> FALSE
(22)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(22)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(22)         if (&User-Name =~ /\.$/)  {
(22)         if (&User-Name =~ /\.$/)   -> FALSE
(22)         if (&User-Name =~ /@\./)  {
(22)         if (&User-Name =~ /@\./)   -> FALSE
(22)       } # if (&User-Name)  = notfound
(22)     } # policy filter_username = notfound
(22)     [preprocess] = ok
(22)     [chap] = noop
(22)     [mschap] = noop
(22)     [digest] = noop
(22) suffix: Checking for suffix after "@"
(22) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(22) suffix: No such realm "NULL"
(22)     [suffix] = noop
(22) eap: Peer sent EAP Response (code 2) ID 84 length 45
(22) eap: No EAP Start, assuming it's an on-going EAP conversation
(22)     [eap] = updated
(22)     [files] = noop
(22)     [expiration] = noop
(22)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(22)     [pap] = noop
(22)   } # authorize = updated
(22) Found Auth-Type = eap
(22) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(22)   authenticate {
(22) eap: Expiring EAP session with state 0xb17fba92b42cb7f7
(22) eap: Finished EAP session with state 0x405d2b634d091c39
(22) eap: Previous EAP request found for state 0x405d2b634d091c39, released from the list
(22) eap: Peer sent packet with method EAP TEAP (55)
(22) eap: Calling submodule eap_teap to process data
(22) eap_teap: Authenticate
(22) eap_teap: (TLS) EAP Done initial handshake
(22) eap_teap: Session established.  Proceeding to decode tunneled attributes
(22) eap_teap: Got Tunneled TEAP TLVs
(22) eap_teap:   FreeRADIUS-EAP-TEAP-EAP-Payload = 0x025300060d00
(22) eap_teap: Processing received EAP Payload
(22) eap_teap: Got tunneled request
(22) eap_teap:   EAP-Message = 0x025300060d00
(22) eap_teap: AUTHENTICATION
(22) Virtual server inner-tunnel received request
(22)   EAP-Message = 0x025300060d00
(22)   FreeRADIUS-Proxied-To = 127.0.0.1
(22)   User-Name = "win11teap@EXTRQA2012.com"
(22)   State = 0xb17fba92b42cb7f706ab2fe838072b73
(22) server inner-tunnel {
(22)   session-state: No cached attributes
(22)   # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(22)     authorize {
(22)       policy filter_username {
(22)         if (&User-Name) {
(22)         if (&User-Name)  -> TRUE
(22)         if (&User-Name)  {
(22)           if (&User-Name =~ / /) {
(22)           if (&User-Name =~ / /)  -> FALSE
(22)           if (&User-Name =~ /@[^@]*@/ ) {
(22)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(22)           if (&User-Name =~ /\.\./ ) {
(22)           if (&User-Name =~ /\.\./ )  -> FALSE
(22)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(22)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(22)           if (&User-Name =~ /\.$/)  {
(22)           if (&User-Name =~ /\.$/)   -> FALSE
(22)           if (&User-Name =~ /@\./)  {
(22)           if (&User-Name =~ /@\./)   -> FALSE
(22)         } # if (&User-Name)  = notfound
(22)       } # policy filter_username = notfound
(22)       [chap] = noop
(22)       [mschap] = noop
(22) suffix: Checking for suffix after "@"
(22) suffix: Looking up realm "EXTRQA2012.com" for User-Name = "win11teap@EXTRQA2012.com"
(22) suffix: No such realm "EXTRQA2012.com"
(22)       [suffix] = noop
(22)       update control {
(22)         &Proxy-To-Realm := LOCAL
(22)       } # update control = noop
(22)       if (&outer.request:EAP-Type == TEAP) {
(22)       if (&outer.request:EAP-Type == TEAP)  -> TRUE
(22)       if (&outer.request:EAP-Type == TEAP)  {
(22)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type) {
(22)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  -> TRUE
(22)         if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  {
(22)           update reply {
(22)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(22)           } # update reply = noop
(22)           update session-state {
(22)             &FreeRADIUS-EAP-TEAP-Identity-Type := Machine
(22)           } # update session-state = noop
(22)         } # if (!&session-state:FreeRADIUS-EAP-TEAP-Identity-Type)  = noop
(22)         ... skipping elsif: Preceding "if" was taken
(22) eap: Peer sent EAP Response (code 2) ID 83 length 6
(22) eap: No EAP Start, assuming it's an on-going EAP conversation
(22)         [eap] = updated
(22)         if (ok) {
(22)         if (ok)  -> FALSE
(22)         update config {
(22)           &Auth-Type := TEAP
(22)         } # update config = noop
(22)       } # if (&outer.request:EAP-Type == TEAP)  = updated
(22)       [files] = noop
(22)       [expiration] = noop
(22)       [logintime] = noop
(22)       [pap] = noop
(22)     } # authorize = updated
(22)   Found Auth-Type = TEAP
(22)   # Executing group from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(22)     Auth-Type TEAP {
(22)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(22)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(22)       if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(22)         update control {
(22)           &EAP-Type := TLS
(22)         } # update control = noop
(22)       } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(22)       ... skipping elsif: Preceding "if" was taken
(22) eap: Expiring EAP session with state 0xb17fba92b42cb7f7
(22) eap: Finished EAP session with state 0xb17fba92b42cb7f7
(22) eap: Previous EAP request found for state 0xb17fba92b42cb7f7, released from the list
(22) eap: Peer sent packet with method EAP TLS (13)
(22) eap: Calling submodule eap_tls to process data
(22) eap_tls: (TLS) Peer ACKed our handshake fragment.  handshake is finished
(22) eap: Sending EAP Success (code 3) ID 83 length 4
(22) eap: Freeing handler
(22)       [eap] = ok
(22)       if (ok) {
(22)       if (ok)  -> TRUE
(22)       if (ok)  {
(22)         if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine) {
(22)         if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  -> TRUE
(22)         if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  {
(22)           update session-state {
(22)             &FreeRADIUS-EAP-TEAP-Identity-Type := User
(22)           } # update session-state = noop
(22)           update reply {
(22)             &FreeRADIUS-EAP-TEAP-Identity-Type := User
(22)           } # update reply = noop
(22)         } # if (&session-state:FreeRADIUS-EAP-TEAP-Identity-Type == Machine)  = noop
(22)         ... skipping elsif: Preceding "if" was taken
(22)         ... skipping else: Preceding "if" was taken
(22)       } # if (ok)  = noop
(22)     } # Auth-Type TEAP = ok
(22)   # Executing section post-auth from file /usr/local/etc/raddb/sites-enabled/inner-tunnel
(22)     post-auth {
(22)       if (0) {
(22)       if (0)  -> FALSE
(22)     } # post-auth = noop
(22) } # server inner-tunnel
(22) Virtual server sending reply
(22)   FreeRADIUS-EAP-TEAP-Identity-Type := User
(22)   MS-MPPE-Recv-Key = 0xbde7e1cf67501bc3e3a737ab8609efd2a4ab60cab65b72172d3c3e71fe2556e7
(22)   MS-MPPE-Send-Key = 0xa9bf867ab9e051258cf40c1f1e175a87bdb8bf10a628a162da728e20ae41d754
(22)   EAP-MSK = 0xbde7e1cf67501bc3e3a737ab8609efd2a4ab60cab65b72172d3c3e71fe2556e7a9bf867ab9e051258cf40c1f1e175a87bdb8bf10a628a162da728e20ae41d754
(22)   EAP-EMSK = 0x87c5f2e3ba941b358c8f46c769e90a22a921bee8a5523952fa539f64f93542ca134858810ee7b34a7bac4f9368d42d8a0eeef4ca018fdb1257349a09b6e48110
(22)   EAP-Session-Id = 0x0d8dfb3c90a2742d5dc913f5713ee7cc6bd927ec8f95dd2f2d6d898b0b21b29864bdd5cd2248f1faf9ed70c1b5e3b10d1c9a4d27d2a8379ff189105355fab1c468
(22)   EAP-Message = 0x03530004
(22)   Message-Authenticator = 0x00000000000000000000000000000000
(22)   User-Name = "win11teap@EXTRQA2012.com"
(22) eap_teap: Got tunneled Access-Accept
(22) eap_teap: MSCHAP_MPPE_RECV_KEY [high MSK] - hexdump(len=32): bd e7 e1 cf 67 50 1b c3 e3 a7 37 ab 86 09 ef d2 a4 ab 60 ca b6 5b 72 17 2d 3c 3e 71 fe 25 56 e7
(22) eap_teap: MSCHAP_MPPE_SEND_KEY [low MSK] - hexdump(len=32): a9 bf 86 7a b9 e0 51 25 8c f4 0c 1f 1e 17 5a 87 bd b8 bf 10 a6 28 a1 62 da 72 8e 20 ae 41 d7 54
(22) eap_teap: Sending Cryptobinding
(22) eap_teap: Updating ICMK (j = 1)
(22) eap_teap: IMSK from MSK - hexdump(len=32): bd e7 e1 cf 67 50 1b c3 e3 a7 37 ab 86 09 ef d2 a4 ab 60 ca b6 5b 72 17 2d 3c 3e 71 fe 25 56 e7
(22) eap_teap: MSK S-IMCK[j] - hexdump(len=40): db 9d f5 c5 09 33 69 f9 e2 30 52 33 e0 e3 ff 4b fe 18 07 ef a0 59 43 5f f4 80 8f 88 5d bf 55 2d 89 b5 20 1d 52 64 5f e4
(22) eap_teap: MSK CMK[j] - hexdump(len=20): 03 97 30 17 06 2b 9e 65 99 20 ee 27 02 0f 98 f1 0d 80 b2 81
(22) eap_teap: IMSK from EMSK - hexdump(len=32): 45 1e 86 cf aa 0e dc 86 03 76 00 7e 87 75 a9 d1 43 ef de 3d ad 2a 74 22 85 3c ca 3f 35 df 60 b9
(22) eap_teap: EMSK S-IMCK[j] - hexdump(len=40): 24 c8 b7 e4 25 9e 01 0e 04 a7 ee 67 4a 9f 1d 28 a5 b5 48 7f 34 31 c1 f0 a5 c8 17 1d e4 6e e0 f8 c1 22 90 62 58 ca 2a e9
(22) eap_teap: EMSK CMK[j] - hexdump(len=20): 38 7a bc 67 ea 0b 37 b3 e3 fc 0b 3c ca 58 42 55 a0 af 32 f1
(22) eap_teap: BUFFER for Compound MAC calculation - hexdump(len=89): 80 0c 00 4c 00 01 01 30 73 3d 74 4b 77 00 f5 37 97 d3 3a ce 02 d0 46 b6 65 8f fb 07 ea 2e ae 1d 0f 58 bc 67 c3 09 c8 aa 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 37 00 01 00 04 31 32 33 34
(22) eap: Sending EAP Request (code 1) ID 85 length 127
(22) eap: EAP session adding &reply:State = 0x405d2b634e081c39
(22)     [eap] = handled
(22)   } # authenticate = handled
(22) Using Post-Auth-Type Challenge
(22) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(22)   Challenge { ... } # empty sub-section is ignored
(22) session-state: Saving cached attributes
(22)   Framed-MTU = 984
(22)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(22)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(22)   TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(22)   TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(22)   TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(22)   TLS-Session-Version = "TLS 1.2"
(22) Sent Access-Challenge Id 147 from 10.54.27.54:1812 to 10.54.22.81:32769 length 185
(22)   EAP-Message = 0x0155007f37011703030074aa281f61c0bb630f982735ad2212786195607cfce0eca499c5516e3898c71a050e84e845f12d6650740efef022bac95bdcbcfa9c8ee9cbeb0aa4da9de489d6166ae0d0284183136f89baa7a1dc5a893f5e2bf754c1dde1fa38518ec172d3afe69b96628a8fa8483915761dadbb338dba612ea240
(22)   Message-Authenticator = 0x00000000000000000000000000000000
(22)   State = 0x405d2b634e081c39e7001e2ea9a60c4c
(22) Finished request
Waking up in 4.6 seconds.
(23) Received Access-Request Id 148 from 10.54.22.81:32769 to 10.54.27.54:1812 length 281
(23)   Message-Authenticator = 0x4dd4cf14470c552df41ab15b9835b84c
(23)   User-Name = "anonymous"
(23)   State = 0x405d2b634e081c39e7001e2ea9a60c4c
(23)   NAS-IP-Address = 10.54.22.81
(23)   Called-Station-Id = "00-04-96-9b-5d-01"
(23)   NAS-Identifier = "X440G2-24t-10G4"
(23)   NAS-Port = 1005
(23)   NAS-Port-Type = Ethernet
(23)   Framed-MTU = 1300
(23)   Service-Type = Framed-User
(23)   Calling-Station-Id = "00-0C-29-F2-BA-A3"
(23)   EAP-Message = 0x0255007f370117030300740000000000000008657b259eb80523d00c251fd4832fae7e5bf1911f535afd686de1bc69fd3a36e8771e033f6f8ec70da79e80853fbf2c155483807f721e6b3f8278eee2d591568e07b2fb223bc1b992c297d816cce33a3c20efba3056604b2aa171294b21fa16e1962c4f21f9625d37432540bd
(23) Restoring &session-state
(23)   &session-state:Framed-MTU = 984
(23)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHello"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Certificate"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerKeyExchange"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, ServerHelloDone"
(23)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, ClientKeyExchange"
(23)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.2 Handshake, Finished"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 ChangeCipherSpec"
(23)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.2 Handshake, Finished"
(23)   &session-state:TLS-Session-Cipher-Suite = "ECDHE-RSA-AES256-GCM-SHA384"
(23)   &session-state:TLS-Session-Version = "TLS 1.2"
(23) # Executing section authorize from file /usr/local/etc/raddb/sites-enabled/default
(23)   authorize {
(23)     policy filter_username {
(23)       if (&User-Name) {
(23)       if (&User-Name)  -> TRUE
(23)       if (&User-Name)  {
(23)         if (&User-Name =~ / /) {
(23)         if (&User-Name =~ / /)  -> FALSE
(23)         if (&User-Name =~ /@[^@]*@/ ) {
(23)         if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(23)         if (&User-Name =~ /\.\./ ) {
(23)         if (&User-Name =~ /\.\./ )  -> FALSE
(23)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(23)         if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(23)         if (&User-Name =~ /\.$/)  {
(23)         if (&User-Name =~ /\.$/)   -> FALSE
(23)         if (&User-Name =~ /@\./)  {
(23)         if (&User-Name =~ /@\./)   -> FALSE
(23)       } # if (&User-Name)  = notfound
(23)     } # policy filter_username = notfound
(23)     [preprocess] = ok
(23)     [chap] = noop
(23)     [mschap] = noop
(23)     [digest] = noop
(23) suffix: Checking for suffix after "@"
(23) suffix: No '@' in User-Name = "anonymous", looking up realm NULL
(23) suffix: No such realm "NULL"
(23)     [suffix] = noop
(23) eap: Peer sent EAP Response (code 2) ID 85 length 127
(23) eap: No EAP Start, assuming it's an on-going EAP conversation
(23)     [eap] = updated
(23)     [files] = noop
(23)     [expiration] = noop
(23)     [logintime] = noop
Not doing PAP as Auth-Type is already set.
(23)     [pap] = noop
(23)   } # authorize = updated
(23) Found Auth-Type = eap
(23) # Executing group from file /usr/local/etc/raddb/sites-enabled/default
(23)   authenticate {
(23) eap: Expiring EAP session with state 0x405d2b634e081c39
(23) eap: Finished EAP session with state 0x405d2b634e081c39
(23) eap: Previous EAP request found for state 0x405d2b634e081c39, released from the list
(23) eap: Peer sent packet with method EAP TEAP (55)
(23) eap: Calling submodule eap_teap to process data
(23) eap_teap: Authenticate
(23) eap_teap: (TLS) EAP Done initial handshake
(23) eap_teap: Session established.  Proceeding to decode tunneled attributes
(23) eap_teap: Got Tunneled TEAP TLVs
(23) eap_teap:   FreeRADIUS-EAP-TEAP-Crypto-Binding = 0x00010121733d744b7700f53797d33ace02d046b6658ffb07ea2eae1d0f58bc67c309c8ab0000000000000000000000000000000000000000fcb8dd63fc7eeff6ffdc86c2992b0401a60d9795
(23) eap_teap:   FreeRADIUS-EAP-TEAP-Intermediate-Result = Success
(23) eap_teap:   FreeRADIUS-EAP-TEAP-Result = Success
(23) eap_teap: BUFFER for Compound MAC calculation - hexdump(len=89): 80 0c 00 4c 00 01 01 21 73 3d 74 4b 77 00 f5 37 97 d3 3a ce 02 d0 46 b6 65 8f fb 07 ea 2e ae 1d 0f 58 bc 67 c3 09 c8 ab 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 37 00 01 00 04 31 32 33 34
(23) eap_teap: S-IMCK[j] - hexdump(len=40): db 9d f5 c5 09 33 69 f9 e2 30 52 33 e0 e3 ff 4b fe 18 07 ef a0 59 43 5f f4 80 8f 88 5d bf 55 2d 89 b5 20 1d 52 64 5f e4
(23) eap_teap: Derived key (MSK) - hexdump(len=64): 9a be 51 b1 7e 62 f9 27 a2 7c 07 64 7a ee dd fd 08 04 01 5e fd 7f 69 bd 18 9c 19 6a 40 a1 ab d7 23 da 58 77 f7 ac e6 f5 b8 29 dc a6 b2 f5 07 09 80 72 9c 2c 9d 8f 52 cd 34 4f d0 1b 88 73 48 49
(23) eap_teap: Derived key (EMSK) - hexdump(len=64): a0 5b c7 40 01 5f 54 d8 c6 06 60 aa bf e9 0f 7a c8 ef 88 87 c1 f5 5a 06 7a 91 10 25 ca b6 24 d5 7b de 31 72 de 44 15 3b 9e 53 74 59 2b fe 67 b6 dd 98 a0 5b 54 31 0f 60 5c 6f dd 05 ae 3e de 0e
(23) eap: Sending EAP Success (code 3) ID 85 length 4
(23) eap: Freeing handler
(23)     [eap] = ok
(23)   } # authenticate = ok
(23) # Executing section post-auth from file /usr/local/etc/raddb/sites-enabled/default
(23)   post-auth {
(23)     if (session-state:User-Name && reply:User-Name && request:User-Name && (reply:User-Name == request:User-Name)) {
(23)     if (session-state:User-Name && reply:User-Name && request:User-Name && (reply:User-Name == request:User-Name))  -> FALSE
(23)     update {
(23)       &reply::Framed-MTU += &session-state:Framed-MTU[*] -> 984
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) recv TLS 1.3 Handshake, ClientHello'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 Handshake, ServerHello'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 Handshake, Certificate'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 Handshake, ServerKeyExchange'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 Handshake, ServerHelloDone'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) recv TLS 1.2 Handshake, ClientKeyExchange'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) recv TLS 1.2 Handshake, Finished'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 ChangeCipherSpec'
(23)       &reply::TLS-Session-Information += &session-state:TLS-Session-Information[*] -> '(TLS) send TLS 1.2 Handshake, Finished'
(23)       &reply::TLS-Session-Cipher-Suite += &session-state:TLS-Session-Cipher-Suite[*] -> 'ECDHE-RSA-AES256-GCM-SHA384'
(23)       &reply::TLS-Session-Version += &session-state:TLS-Session-Version[*] -> 'TLS 1.2'
(23)     } # update = noop
(23)     [exec] = noop
(23)     policy remove_reply_message_if_eap {
(23)       if (&reply:EAP-Message && &reply:Reply-Message) {
(23)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(23)       else {
(23)         [noop] = noop
(23)       } # else = noop
(23)     } # policy remove_reply_message_if_eap = noop
(23)     if (EAP-Key-Name && &reply:EAP-Session-Id) {
(23)     if (EAP-Key-Name && &reply:EAP-Session-Id)  -> FALSE
(23)   } # post-auth = noop
(23) Sent Access-Accept Id 148 from 10.54.27.54:1812 to 10.54.22.81:32769 length 177
(23)   MS-MPPE-Recv-Key = 0x9abe51b17e62f927a27c07647aeeddfd0804015efd7f69bd189c196a40a1abd7
(23)   MS-MPPE-Send-Key = 0x23da5877f7ace6f5b829dca6b2f5070980729c2c9d8f52cd344fd01b88734849
(23)   EAP-Message = 0x03550004
(23)   Message-Authenticator = 0x00000000000000000000000000000000
(23)   User-Name = "anonymous"
(23)   Framed-MTU += 984
(23) Finished request
Waking up in 4.6 seconds.
(8) Cleaning up request packet ID 133 with timestamp +102 due to cleanup_delay was reached
(9) Cleaning up request packet ID 134 with timestamp +102 due to cleanup_delay was reached
(10) Cleaning up request packet ID 135 with timestamp +102 due to cleanup_delay was reached
(11) Cleaning up request packet ID 136 with timestamp +102 due to cleanup_delay was reached
(12) Cleaning up request packet ID 137 with timestamp +102 due to cleanup_delay was reached
(13) Cleaning up request packet ID 138 with timestamp +102 due to cleanup_delay was reached
(14) Cleaning up request packet ID 139 with timestamp +102 due to cleanup_delay was reached
(15) Cleaning up request packet ID 140 with timestamp +102 due to cleanup_delay was reached
Waking up in 0.1 seconds.
(16) Cleaning up request packet ID 141 with timestamp +102 due to cleanup_delay was reached
(17) Cleaning up request packet ID 142 with timestamp +102 due to cleanup_delay was reached
(18) Cleaning up request packet ID 143 with timestamp +102 due to cleanup_delay was reached
(19) Cleaning up request packet ID 144 with timestamp +102 due to cleanup_delay was reached
(20) Cleaning up request packet ID 145 with timestamp +102 due to cleanup_delay was reached
(21) Cleaning up request packet ID 146 with timestamp +102 due to cleanup_delay was reached
(22) Cleaning up request packet ID 147 with timestamp +102 due to cleanup_delay was reached
(23) Cleaning up request packet ID 148 with timestamp +102 due to cleanup_delay was reached
Ready to process requests
